import{a as $t}from"./chunk-PQ5267D7.js";import{n as Rt}from"./chunk-JI6IB25M.js";var Ee=Object.create,Bt=Object.defineProperty,Ie=Object.getOwnPropertyDescriptor,he=Object.getOwnPropertyNames,Ot=Object.getOwnPropertySymbols,Ve=Object.getPrototypeOf,fe=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable,N=Math.pow,Ut=(t,r,i)=>r in t?Bt(t,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[r]=i,Ae=(t,r)=>{for(var i in r||(r={}))fe.call(r,i)&&Ut(t,i,r[i]);if(Ot)for(var i of Ot(r))Pe.call(r,i)&&Ut(t,i,r[i]);return t},G=(t,r)=>function(){return r||(0,t[he(t)[0]])((r={exports:{}}).exports,r),r.exports},je=(t,r,i,e)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of he(r))!fe.call(t,n)&&n!==i&&Bt(t,n,{get:()=>r[n],enumerable:!(e=Ie(r,n))||e.enumerable});return t},W=(t,r,i)=>(i=t!=null?Ee(Ve(t)):{},je(r||!t||!t.__esModule?Bt(i,"default",{value:t,enumerable:!0}):i,t)),ft=(t,r,i)=>new Promise((e,n)=>{var s=l=>{try{o(i.next(l))}catch(f){n(f)}},a=l=>{try{o(i.throw(l))}catch(f){n(f)}},o=l=>l.done?e(l.value):Promise.resolve(l.value).then(s,a);o((i=i.apply(t,r)).next())}),rt=G({"node_modules/@mapbox/point-geometry/index.js"(t,r){"use strict";r.exports=i;function i(e,n){this.x=e,this.y=n}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,n){return this.clone()._rotateAround(e,n)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var n=e.x-this.x,s=e.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,n){return Math.atan2(this.x*n-this.y*e,this.x*e+this.y*n)},_matMult:function(e){var n=e[0]*this.x+e[1]*this.y,s=e[2]*this.x+e[3]*this.y;return this.x=n,this.y=s,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var n=Math.cos(e),s=Math.sin(e),a=n*this.x-s*this.y,o=s*this.x+n*this.y;return this.x=a,this.y=o,this},_rotateAround:function(e,n){var s=Math.cos(e),a=Math.sin(e),o=n.x+s*(this.x-n.x)-a*(this.y-n.y),l=n.y+a*(this.x-n.x)+s*(this.y-n.y);return this.x=o,this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(e){return e instanceof i?e:Array.isArray(e)?new i(e[0],e[1]):e}}}),Re=G({"node_modules/@mapbox/unitbezier/index.js"(t,r){r.exports=i;function i(e,n,s,a){this.cx=3*e,this.bx=3*(s-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(a-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=a,this.p2x=s,this.p2y=a}i.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},i.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},i.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},i.prototype.solveCurveX=function(e,n){typeof n>"u"&&(n=1e-6);var s,a,o,l,f;for(o=e,f=0;f<8;f++){if(l=this.sampleCurveX(o)-e,Math.abs(l)<n)return o;var u=this.sampleCurveDerivativeX(o);if(Math.abs(u)<1e-6)break;o=o-l/u}if(s=0,a=1,o=e,o<s)return s;if(o>a)return a;for(;s<a;){if(l=this.sampleCurveX(o),Math.abs(l-e)<n)return o;e>l?s=o:a=o,o=(a-s)*.5+s}return o},i.prototype.solve=function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}}}),$e=G({"node_modules/tinyqueue/tinyqueue.js"(t,r){(function(i,e){typeof t=="object"&&typeof r<"u"?r.exports=e():typeof define=="function"&&define.amd?define(e):(i=i||self,i.TinyQueue=e())})(t,function(){"use strict";var i=function(s,a){if(s===void 0&&(s=[]),a===void 0&&(a=e),this.data=s,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};i.prototype.push=function(s){this.data.push(s),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var s=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),s}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(s){for(var a=this,o=a.data,l=a.compare,f=o[s];s>0;){var u=s-1>>1,d=o[u];if(l(f,d)>=0)break;o[s]=d,s=u}o[s]=f},i.prototype._down=function(s){for(var a=this,o=a.data,l=a.compare,f=this.length>>1,u=o[s];s<f;){var d=(s<<1)+1,w=o[d],x=d+1;if(x<this.length&&l(o[x],w)<0&&(d=x,w=o[x]),l(w,u)>=0)break;o[s]=w,s=d}o[s]=u};function e(n,s){return n<s?-1:n>s?1:0}return i})}}),Oe=G({"node_modules/polylabel/polylabel.js"(t,r){"use strict";var i=$e();i.default&&(i=i.default),r.exports=e,r.exports.default=e;function e(f,u,d){u=u||1;for(var w,x,v,F,k=0;k<f[0].length;k++){var S=f[0][k];(!k||S[0]<w)&&(w=S[0]),(!k||S[1]<x)&&(x=S[1]),(!k||S[0]>v)&&(v=S[0]),(!k||S[1]>F)&&(F=S[1])}var c=v-w,m=F-x,y=Math.min(c,m),z=y/2;if(y===0){var b=[w,x];return b.distance=0,b}for(var _=new i(void 0,n),M=w;M<v;M+=y)for(var T=x;T<F;T+=y)_.push(new s(M+z,T+z,z,f));var B=o(f),E=new s(w+c/2,x+m/2,0,f);E.d>B.d&&(B=E);for(var P=_.length;_.length;){var X=_.pop();X.d>B.d&&(B=X,d&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,P)),!(X.max-B.d<=u)&&(z=X.h/2,_.push(new s(X.x-z,X.y-z,z,f)),_.push(new s(X.x+z,X.y-z,z,f)),_.push(new s(X.x-z,X.y+z,z,f)),_.push(new s(X.x+z,X.y+z,z,f)),P+=4)}d&&(console.log("num probes: "+P),console.log("best distance: "+B.d));var h=[B.x,B.y];return h.distance=B.d,h}function n(f,u){return u.max-f.max}function s(f,u,d,w){this.x=f,this.y=u,this.h=d,this.d=a(f,u,w),this.max=this.d+this.h*Math.SQRT2}function a(f,u,d){for(var w=!1,x=1/0,v=0;v<d.length;v++)for(var F=d[v],k=0,S=F.length,c=S-1;k<S;c=k++){var m=F[k],y=F[c];m[1]>u!=y[1]>u&&f<(y[0]-m[0])*(u-m[1])/(y[1]-m[1])+m[0]&&(w=!w),x=Math.min(x,l(f,u,m,y))}return x===0?0:(w?1:-1)*Math.sqrt(x)}function o(f){for(var u=0,d=0,w=0,x=f[0],v=0,F=x.length,k=F-1;v<F;k=v++){var S=x[v],c=x[k],m=S[0]*c[1]-c[0]*S[1];d+=(S[0]+c[0])*m,w+=(S[1]+c[1])*m,u+=m*3}return u===0?new s(x[0][0],x[0][1],0,f):new s(d/u,w/u,0,f)}function l(f,u,d,w){var x=d[0],v=d[1],F=w[0]-x,k=w[1]-v;if(F!==0||k!==0){var S=((f-x)*F+(u-v)*k)/(F*F+k*k);S>1?(x=w[0],v=w[1]):S>0&&(x+=F*S,v+=k*S)}return F=f-x,k=u-v,F*F+k*k}}}),ue=G({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(t,r){"use strict";var i=rt();r.exports=e;function e(l,f,u,d,w){this.properties={},this.extent=u,this.type=0,this._pbf=l,this._geometry=-1,this._keys=d,this._values=w,l.readFields(n,this,f)}function n(l,f,u){l==1?f.id=u.readVarint():l==2?s(u,f):l==3?f.type=u.readVarint():l==4&&(f._geometry=u.pos)}function s(l,f){for(var u=l.readVarint()+l.pos;l.pos<u;){var d=f._keys[l.readVarint()],w=f._values[l.readVarint()];f.properties[d]=w}}e.types=["Unknown","Point","LineString","Polygon"],e.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var f=l.readVarint()+l.pos,u=1,d=0,w=0,x=0,v=[],F;l.pos<f;){if(d<=0){var k=l.readVarint();u=k&7,d=k>>3}if(d--,u===1||u===2)w+=l.readSVarint(),x+=l.readSVarint(),u===1&&(F&&v.push(F),F=[]),F.push(new i(w,x));else if(u===7)F&&F.push(F[0].clone());else throw new Error("unknown command "+u)}return F&&v.push(F),v},e.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var f=l.readVarint()+l.pos,u=1,d=0,w=0,x=0,v=1/0,F=-1/0,k=1/0,S=-1/0;l.pos<f;){if(d<=0){var c=l.readVarint();u=c&7,d=c>>3}if(d--,u===1||u===2)w+=l.readSVarint(),x+=l.readSVarint(),w<v&&(v=w),w>F&&(F=w),x<k&&(k=x),x>S&&(S=x);else if(u!==7)throw new Error("unknown command "+u)}return[v,k,F,S]},e.prototype.toGeoJSON=function(l,f,u){var d=this.extent*Math.pow(2,u),w=this.extent*l,x=this.extent*f,v=this.loadGeometry(),F=e.types[this.type],k,S;function c(z){for(var b=0;b<z.length;b++){var _=z[b],M=180-(_.y+x)*360/d;z[b]=[(_.x+w)*360/d-180,360/Math.PI*Math.atan(Math.exp(M*Math.PI/180))-90]}}switch(this.type){case 1:var m=[];for(k=0;k<v.length;k++)m[k]=v[k][0];v=m,c(v);break;case 2:for(k=0;k<v.length;k++)c(v[k]);break;case 3:for(v=a(v),k=0;k<v.length;k++)for(S=0;S<v[k].length;S++)c(v[k][S]);break}v.length===1?v=v[0]:F="Multi"+F;var y={type:"Feature",geometry:{type:F,coordinates:v},properties:this.properties};return"id"in this&&(y.id=this.id),y};function a(l){var f=l.length;if(f<=1)return[l];for(var u=[],d,w,x=0;x<f;x++){var v=o(l[x]);v!==0&&(w===void 0&&(w=v<0),w===v<0?(d&&u.push(d),d=[l[x]]):d.push(l[x]))}return d&&u.push(d),u}function o(l){for(var f=0,u=0,d=l.length,w=d-1,x,v;u<d;w=u++)x=l[u],v=l[w],f+=(v.x-x.x)*(x.y+v.y);return f}}}),ce=G({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(t,r){"use strict";var i=ue();r.exports=e;function e(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(n,this,o),this.length=this._features.length}function n(a,o,l){a===15?o.version=l.readVarint():a===1?o.name=l.readString():a===5?o.extent=l.readVarint():a===2?o._features.push(l.pos):a===3?o._keys.push(l.readString()):a===4&&o._values.push(s(l))}function s(a){for(var o=null,l=a.readVarint()+a.pos;a.pos<l;){var f=a.readVarint()>>3;o=f===1?a.readString():f===2?a.readFloat():f===3?a.readDouble():f===4?a.readVarint64():f===5?a.readVarint():f===6?a.readSVarint():f===7?a.readBoolean():null}return o}e.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,o,this.extent,this._keys,this._values)}}}),Ue=G({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(t,r){"use strict";var i=ce();r.exports=e;function e(s,a){this.layers=s.readFields(n,{},a)}function n(s,a,o){if(s===3){var l=new i(o,o.readVarint()+o.pos);l.length&&(a[l.name]=l)}}}}),qe=G({"node_modules/@mapbox/vector-tile/index.js"(t,r){r.exports.VectorTile=Ue(),r.exports.VectorTileFeature=ue(),r.exports.VectorTileLayer=ce()}}),We=G({"node_modules/ieee754/index.js"(t){t.read=function(r,i,e,n,s){var a,o,l=s*8-n-1,f=(1<<l)-1,u=f>>1,d=-7,w=e?s-1:0,x=e?-1:1,v=r[i+w];for(w+=x,a=v&(1<<-d)-1,v>>=-d,d+=l;d>0;a=a*256+r[i+w],w+=x,d-=8);for(o=a&(1<<-d)-1,a>>=-d,d+=n;d>0;o=o*256+r[i+w],w+=x,d-=8);if(a===0)a=1-u;else{if(a===f)return o?NaN:(v?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-u}return(v?-1:1)*o*Math.pow(2,a-n)},t.write=function(r,i,e,n,s,a){var o,l,f,u=a*8-s-1,d=(1<<u)-1,w=d>>1,x=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=n?0:a-1,F=n?1:-1,k=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(l=isNaN(i)?1:0,o=d):(o=Math.floor(Math.log(i)/Math.LN2),i*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+w>=1?i+=x/f:i+=x*Math.pow(2,1-w),i*f>=2&&(o++,f/=2),o+w>=d?(l=0,o=d):o+w>=1?(l=(i*f-1)*Math.pow(2,s),o=o+w):(l=i*Math.pow(2,w-1)*Math.pow(2,s),o=0));s>=8;r[e+v]=l&255,v+=F,l/=256,s-=8);for(o=o<<s|l,u+=s;u>0;r[e+v]=o&255,v+=F,o/=256,u-=8);r[e+v-F]|=k*128}}}),Ne=G({"node_modules/pbf/index.js"(t,r){"use strict";r.exports=e;var i=We();function e(h){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(h)?h:new Uint8Array(h||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var n=65536*65536,s=1/n,a=12,o=typeof TextDecoder>"u"?null:new TextDecoder("utf8");e.prototype={destroy:function(){this.buf=null},readFields:function(h,p,g){for(g=g||this.length;this.pos<g;){var D=this.readVarint(),C=D>>3,Y=this.pos;this.type=D&7,h(C,p,this),this.pos===Y&&this.skip(D)}return p},readMessage:function(h,p){return this.readFields(h,p,this.readVarint()+this.pos)},readFixed32:function(){var h=M(this.buf,this.pos);return this.pos+=4,h},readSFixed32:function(){var h=B(this.buf,this.pos);return this.pos+=4,h},readFixed64:function(){var h=M(this.buf,this.pos)+M(this.buf,this.pos+4)*n;return this.pos+=8,h},readSFixed64:function(){var h=M(this.buf,this.pos)+B(this.buf,this.pos+4)*n;return this.pos+=8,h},readFloat:function(){var h=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,h},readDouble:function(){var h=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,h},readVarint:function(h){var p=this.buf,g,D;return D=p[this.pos++],g=D&127,D<128||(D=p[this.pos++],g|=(D&127)<<7,D<128)||(D=p[this.pos++],g|=(D&127)<<14,D<128)||(D=p[this.pos++],g|=(D&127)<<21,D<128)?g:(D=p[this.pos],g|=(D&15)<<28,l(g,h,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var h=this.readVarint();return h%2===1?(h+1)/-2:h/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var h=this.readVarint()+this.pos,p=this.pos;return this.pos=h,h-p>=a&&o?P(this.buf,p,h):E(this.buf,p,h)},readBytes:function(){var h=this.readVarint()+this.pos,p=this.buf.subarray(this.pos,h);return this.pos=h,p},readPackedVarint:function(h,p){if(this.type!==e.Bytes)return h.push(this.readVarint(p));var g=f(this);for(h=h||[];this.pos<g;)h.push(this.readVarint(p));return h},readPackedSVarint:function(h){if(this.type!==e.Bytes)return h.push(this.readSVarint());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readSVarint());return h},readPackedBoolean:function(h){if(this.type!==e.Bytes)return h.push(this.readBoolean());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readBoolean());return h},readPackedFloat:function(h){if(this.type!==e.Bytes)return h.push(this.readFloat());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readFloat());return h},readPackedDouble:function(h){if(this.type!==e.Bytes)return h.push(this.readDouble());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readDouble());return h},readPackedFixed32:function(h){if(this.type!==e.Bytes)return h.push(this.readFixed32());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readFixed32());return h},readPackedSFixed32:function(h){if(this.type!==e.Bytes)return h.push(this.readSFixed32());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readSFixed32());return h},readPackedFixed64:function(h){if(this.type!==e.Bytes)return h.push(this.readFixed64());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readFixed64());return h},readPackedSFixed64:function(h){if(this.type!==e.Bytes)return h.push(this.readSFixed64());var p=f(this);for(h=h||[];this.pos<p;)h.push(this.readSFixed64());return h},skip:function(h){var p=h&7;if(p===e.Varint)for(;this.buf[this.pos++]>127;);else if(p===e.Bytes)this.pos=this.readVarint()+this.pos;else if(p===e.Fixed32)this.pos+=4;else if(p===e.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+p)},writeTag:function(h,p){this.writeVarint(h<<3|p)},realloc:function(h){for(var p=this.length||16;p<this.pos+h;)p*=2;if(p!==this.length){var g=new Uint8Array(p);g.set(this.buf),this.buf=g,this.length=p}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(h){this.realloc(4),T(this.buf,h,this.pos),this.pos+=4},writeSFixed32:function(h){this.realloc(4),T(this.buf,h,this.pos),this.pos+=4},writeFixed64:function(h){this.realloc(8),T(this.buf,h&-1,this.pos),T(this.buf,Math.floor(h*s),this.pos+4),this.pos+=8},writeSFixed64:function(h){this.realloc(8),T(this.buf,h&-1,this.pos),T(this.buf,Math.floor(h*s),this.pos+4),this.pos+=8},writeVarint:function(h){if(h=+h||0,h>268435455||h<0){d(h,this);return}this.realloc(4),this.buf[this.pos++]=h&127|(h>127?128:0),!(h<=127)&&(this.buf[this.pos++]=(h>>>=7)&127|(h>127?128:0),!(h<=127)&&(this.buf[this.pos++]=(h>>>=7)&127|(h>127?128:0),!(h<=127)&&(this.buf[this.pos++]=h>>>7&127)))},writeSVarint:function(h){this.writeVarint(h<0?-h*2-1:h*2)},writeBoolean:function(h){this.writeVarint(!!h)},writeString:function(h){h=String(h),this.realloc(h.length*4),this.pos++;var p=this.pos;this.pos=X(this.buf,h,this.pos);var g=this.pos-p;g>=128&&v(p,g,this),this.pos=p-1,this.writeVarint(g),this.pos+=g},writeFloat:function(h){this.realloc(4),i.write(this.buf,h,this.pos,!0,23,4),this.pos+=4},writeDouble:function(h){this.realloc(8),i.write(this.buf,h,this.pos,!0,52,8),this.pos+=8},writeBytes:function(h){var p=h.length;this.writeVarint(p),this.realloc(p);for(var g=0;g<p;g++)this.buf[this.pos++]=h[g]},writeRawMessage:function(h,p){this.pos++;var g=this.pos;h(p,this);var D=this.pos-g;D>=128&&v(g,D,this),this.pos=g-1,this.writeVarint(D),this.pos+=D},writeMessage:function(h,p,g){this.writeTag(h,e.Bytes),this.writeRawMessage(p,g)},writePackedVarint:function(h,p){p.length&&this.writeMessage(h,F,p)},writePackedSVarint:function(h,p){p.length&&this.writeMessage(h,k,p)},writePackedBoolean:function(h,p){p.length&&this.writeMessage(h,m,p)},writePackedFloat:function(h,p){p.length&&this.writeMessage(h,S,p)},writePackedDouble:function(h,p){p.length&&this.writeMessage(h,c,p)},writePackedFixed32:function(h,p){p.length&&this.writeMessage(h,y,p)},writePackedSFixed32:function(h,p){p.length&&this.writeMessage(h,z,p)},writePackedFixed64:function(h,p){p.length&&this.writeMessage(h,b,p)},writePackedSFixed64:function(h,p){p.length&&this.writeMessage(h,_,p)},writeBytesField:function(h,p){this.writeTag(h,e.Bytes),this.writeBytes(p)},writeFixed32Field:function(h,p){this.writeTag(h,e.Fixed32),this.writeFixed32(p)},writeSFixed32Field:function(h,p){this.writeTag(h,e.Fixed32),this.writeSFixed32(p)},writeFixed64Field:function(h,p){this.writeTag(h,e.Fixed64),this.writeFixed64(p)},writeSFixed64Field:function(h,p){this.writeTag(h,e.Fixed64),this.writeSFixed64(p)},writeVarintField:function(h,p){this.writeTag(h,e.Varint),this.writeVarint(p)},writeSVarintField:function(h,p){this.writeTag(h,e.Varint),this.writeSVarint(p)},writeStringField:function(h,p){this.writeTag(h,e.Bytes),this.writeString(p)},writeFloatField:function(h,p){this.writeTag(h,e.Fixed32),this.writeFloat(p)},writeDoubleField:function(h,p){this.writeTag(h,e.Fixed64),this.writeDouble(p)},writeBooleanField:function(h,p){this.writeVarintField(h,!!p)}};function l(h,p,g){var D=g.buf,C,Y;if(Y=D[g.pos++],C=(Y&112)>>4,Y<128||(Y=D[g.pos++],C|=(Y&127)<<3,Y<128)||(Y=D[g.pos++],C|=(Y&127)<<10,Y<128)||(Y=D[g.pos++],C|=(Y&127)<<17,Y<128)||(Y=D[g.pos++],C|=(Y&127)<<24,Y<128)||(Y=D[g.pos++],C|=(Y&1)<<31,Y<128))return u(h,C,p);throw new Error("Expected varint not more than 10 bytes")}function f(h){return h.type===e.Bytes?h.readVarint()+h.pos:h.pos+1}function u(h,p,g){return g?p*4294967296+(h>>>0):(p>>>0)*4294967296+(h>>>0)}function d(h,p){var g,D;if(h>=0?(g=h%4294967296|0,D=h/4294967296|0):(g=~(-h%4294967296),D=~(-h/4294967296),g^4294967295?g=g+1|0:(g=0,D=D+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),w(g,D,p),x(D,p)}function w(h,p,g){g.buf[g.pos++]=h&127|128,h>>>=7,g.buf[g.pos++]=h&127|128,h>>>=7,g.buf[g.pos++]=h&127|128,h>>>=7,g.buf[g.pos++]=h&127|128,h>>>=7,g.buf[g.pos]=h&127}function x(h,p){var g=(h&7)<<4;p.buf[p.pos++]|=g|((h>>>=3)?128:0),h&&(p.buf[p.pos++]=h&127|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=h&127|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=h&127|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=h&127|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=h&127)))))}function v(h,p,g){var D=p<=16383?1:p<=2097151?2:p<=268435455?3:Math.floor(Math.log(p)/(Math.LN2*7));g.realloc(D);for(var C=g.pos-1;C>=h;C--)g.buf[C+D]=g.buf[C]}function F(h,p){for(var g=0;g<h.length;g++)p.writeVarint(h[g])}function k(h,p){for(var g=0;g<h.length;g++)p.writeSVarint(h[g])}function S(h,p){for(var g=0;g<h.length;g++)p.writeFloat(h[g])}function c(h,p){for(var g=0;g<h.length;g++)p.writeDouble(h[g])}function m(h,p){for(var g=0;g<h.length;g++)p.writeBoolean(h[g])}function y(h,p){for(var g=0;g<h.length;g++)p.writeFixed32(h[g])}function z(h,p){for(var g=0;g<h.length;g++)p.writeSFixed32(h[g])}function b(h,p){for(var g=0;g<h.length;g++)p.writeFixed64(h[g])}function _(h,p){for(var g=0;g<h.length;g++)p.writeSFixed64(h[g])}function M(h,p){return(h[p]|h[p+1]<<8|h[p+2]<<16)+h[p+3]*16777216}function T(h,p,g){h[g]=p,h[g+1]=p>>>8,h[g+2]=p>>>16,h[g+3]=p>>>24}function B(h,p){return(h[p]|h[p+1]<<8|h[p+2]<<16)+(h[p+3]<<24)}function E(h,p,g){for(var D="",C=p;C<g;){var Y=h[C],I=null,R=Y>239?4:Y>223?3:Y>191?2:1;if(C+R>g)break;var A,Q,nt;R===1?Y<128&&(I=Y):R===2?(A=h[C+1],(A&192)===128&&(I=(Y&31)<<6|A&63,I<=127&&(I=null))):R===3?(A=h[C+1],Q=h[C+2],(A&192)===128&&(Q&192)===128&&(I=(Y&15)<<12|(A&63)<<6|Q&63,(I<=2047||I>=55296&&I<=57343)&&(I=null))):R===4&&(A=h[C+1],Q=h[C+2],nt=h[C+3],(A&192)===128&&(Q&192)===128&&(nt&192)===128&&(I=(Y&15)<<18|(A&63)<<12|(Q&63)<<6|nt&63,(I<=65535||I>=1114112)&&(I=null))),I===null?(I=65533,R=1):I>65535&&(I-=65536,D+=String.fromCharCode(I>>>10&1023|55296),I=56320|I&1023),D+=String.fromCharCode(I),C+=R}return D}function P(h,p,g){return o.decode(h.subarray(p,g))}function X(h,p,g){for(var D=0,C,Y;D<p.length;D++){if(C=p.charCodeAt(D),C>55295&&C<57344)if(Y)if(C<56320){h[g++]=239,h[g++]=191,h[g++]=189,Y=C;continue}else C=Y-55296<<10|C-56320|65536,Y=null;else{C>56319||D+1===p.length?(h[g++]=239,h[g++]=191,h[g++]=189):Y=C;continue}else Y&&(h[g++]=239,h[g++]=191,h[g++]=189,Y=null);C<128?h[g++]=C:(C<2048?h[g++]=C>>6|192:(C<65536?h[g++]=C>>12|224:(h[g++]=C>>18|240,h[g++]=C>>12&63|128),h[g++]=C>>6&63|128),h[g++]=C&63|128)}return g}}}),Ze=G({"node_modules/rbush/rbush.min.js"(t,r){(function(i,e){typeof t=="object"&&typeof r<"u"?r.exports=e():typeof define=="function"&&define.amd?define(e):(i=i||self).RBush=e()})(t,function(){"use strict";function i(c,m,y,z,b){(function _(M,T,B,E,P){for(;E>B;){if(E-B>600){var X=E-B+1,h=T-B+1,p=Math.log(X),g=.5*Math.exp(2*p/3),D=.5*Math.sqrt(p*g*(X-g)/X)*(h-X/2<0?-1:1),C=Math.max(B,Math.floor(T-h*g/X+D)),Y=Math.min(E,Math.floor(T+(X-h)*g/X+D));_(M,T,C,Y,P)}var I=M[T],R=B,A=E;for(e(M,B,T),P(M[E],I)>0&&e(M,B,E);R<A;){for(e(M,R,A),R++,A--;P(M[R],I)<0;)R++;for(;P(M[A],I)>0;)A--}P(M[B],I)===0?e(M,B,A):e(M,++A,E),A<=T&&(B=A+1),T<=A&&(E=A-1)}})(c,m,y||0,z||c.length-1,b||n)}function e(c,m,y){var z=c[m];c[m]=c[y],c[y]=z}function n(c,m){return c<m?-1:c>m?1:0}var s=function(c){c===void 0&&(c=9),this._maxEntries=Math.max(4,c),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(c,m,y){if(!y)return m.indexOf(c);for(var z=0;z<m.length;z++)if(y(c,m[z]))return z;return-1}function o(c,m){l(c,0,c.children.length,m,c)}function l(c,m,y,z,b){b||(b=k(null)),b.minX=1/0,b.minY=1/0,b.maxX=-1/0,b.maxY=-1/0;for(var _=m;_<y;_++){var M=c.children[_];f(b,c.leaf?z(M):M)}return b}function f(c,m){return c.minX=Math.min(c.minX,m.minX),c.minY=Math.min(c.minY,m.minY),c.maxX=Math.max(c.maxX,m.maxX),c.maxY=Math.max(c.maxY,m.maxY),c}function u(c,m){return c.minX-m.minX}function d(c,m){return c.minY-m.minY}function w(c){return(c.maxX-c.minX)*(c.maxY-c.minY)}function x(c){return c.maxX-c.minX+(c.maxY-c.minY)}function v(c,m){return c.minX<=m.minX&&c.minY<=m.minY&&m.maxX<=c.maxX&&m.maxY<=c.maxY}function F(c,m){return m.minX<=c.maxX&&m.minY<=c.maxY&&m.maxX>=c.minX&&m.maxY>=c.minY}function k(c){return{children:c,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function S(c,m,y,z,b){for(var _=[m,y];_.length;)if(!((y=_.pop())-(m=_.pop())<=z)){var M=m+Math.ceil((y-m)/z/2)*z;i(c,M,m,y,b),_.push(m,M,M,y)}}return s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(c){var m=this.data,y=[];if(!F(c,m))return y;for(var z=this.toBBox,b=[];m;){for(var _=0;_<m.children.length;_++){var M=m.children[_],T=m.leaf?z(M):M;F(c,T)&&(m.leaf?y.push(M):v(c,T)?this._all(M,y):b.push(M))}m=b.pop()}return y},s.prototype.collides=function(c){var m=this.data;if(!F(c,m))return!1;for(var y=[];m;){for(var z=0;z<m.children.length;z++){var b=m.children[z],_=m.leaf?this.toBBox(b):b;if(F(c,_)){if(m.leaf||v(c,_))return!0;y.push(b)}}m=y.pop()}return!1},s.prototype.load=function(c){if(!c||!c.length)return this;if(c.length<this._minEntries){for(var m=0;m<c.length;m++)this.insert(c[m]);return this}var y=this._build(c.slice(),0,c.length-1,0);if(this.data.children.length)if(this.data.height===y.height)this._splitRoot(this.data,y);else{if(this.data.height<y.height){var z=this.data;this.data=y,y=z}this._insert(y,this.data.height-y.height-1,!0)}else this.data=y;return this},s.prototype.insert=function(c){return c&&this._insert(c,this.data.height-1),this},s.prototype.clear=function(){return this.data=k([]),this},s.prototype.remove=function(c,m){if(!c)return this;for(var y,z,b,_=this.data,M=this.toBBox(c),T=[],B=[];_||T.length;){if(_||(_=T.pop(),z=T[T.length-1],y=B.pop(),b=!0),_.leaf){var E=a(c,_.children,m);if(E!==-1)return _.children.splice(E,1),T.push(_),this._condense(T),this}b||_.leaf||!v(_,M)?z?(y++,_=z.children[y],b=!1):_=null:(T.push(_),B.push(y),y=0,z=_,_=_.children[0])}return this},s.prototype.toBBox=function(c){return c},s.prototype.compareMinX=function(c,m){return c.minX-m.minX},s.prototype.compareMinY=function(c,m){return c.minY-m.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(c){return this.data=c,this},s.prototype._all=function(c,m){for(var y=[];c;)c.leaf?m.push.apply(m,c.children):y.push.apply(y,c.children),c=y.pop();return m},s.prototype._build=function(c,m,y,z){var b,_=y-m+1,M=this._maxEntries;if(_<=M)return o(b=k(c.slice(m,y+1)),this.toBBox),b;z||(z=Math.ceil(Math.log(_)/Math.log(M)),M=Math.ceil(_/Math.pow(M,z-1))),(b=k([])).leaf=!1,b.height=z;var T=Math.ceil(_/M),B=T*Math.ceil(Math.sqrt(M));S(c,m,y,B,this.compareMinX);for(var E=m;E<=y;E+=B){var P=Math.min(E+B-1,y);S(c,E,P,T,this.compareMinY);for(var X=E;X<=P;X+=T){var h=Math.min(X+T-1,P);b.children.push(this._build(c,X,h,z-1))}}return o(b,this.toBBox),b},s.prototype._chooseSubtree=function(c,m,y,z){for(;z.push(m),!m.leaf&&z.length-1!==y;){for(var b=1/0,_=1/0,M=void 0,T=0;T<m.children.length;T++){var B=m.children[T],E=w(B),P=(X=c,h=B,(Math.max(h.maxX,X.maxX)-Math.min(h.minX,X.minX))*(Math.max(h.maxY,X.maxY)-Math.min(h.minY,X.minY))-E);P<_?(_=P,b=E<b?E:b,M=B):P===_&&E<b&&(b=E,M=B)}m=M||m.children[0]}var X,h;return m},s.prototype._insert=function(c,m,y){var z=y?c:this.toBBox(c),b=[],_=this._chooseSubtree(z,this.data,m,b);for(_.children.push(c),f(_,z);m>=0&&b[m].children.length>this._maxEntries;)this._split(b,m),m--;this._adjustParentBBoxes(z,b,m)},s.prototype._split=function(c,m){var y=c[m],z=y.children.length,b=this._minEntries;this._chooseSplitAxis(y,b,z);var _=this._chooseSplitIndex(y,b,z),M=k(y.children.splice(_,y.children.length-_));M.height=y.height,M.leaf=y.leaf,o(y,this.toBBox),o(M,this.toBBox),m?c[m-1].children.push(M):this._splitRoot(y,M)},s.prototype._splitRoot=function(c,m){this.data=k([c,m]),this.data.height=c.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(c,m,y){for(var z,b,_,M,T,B,E,P=1/0,X=1/0,h=m;h<=y-m;h++){var p=l(c,0,h,this.toBBox),g=l(c,h,y,this.toBBox),D=(b=p,_=g,M=void 0,T=void 0,B=void 0,E=void 0,M=Math.max(b.minX,_.minX),T=Math.max(b.minY,_.minY),B=Math.min(b.maxX,_.maxX),E=Math.min(b.maxY,_.maxY),Math.max(0,B-M)*Math.max(0,E-T)),C=w(p)+w(g);D<P?(P=D,z=h,X=C<X?C:X):D===P&&C<X&&(X=C,z=h)}return z||y-m},s.prototype._chooseSplitAxis=function(c,m,y){var z=c.leaf?this.compareMinX:u,b=c.leaf?this.compareMinY:d;this._allDistMargin(c,m,y,z)<this._allDistMargin(c,m,y,b)&&c.children.sort(z)},s.prototype._allDistMargin=function(c,m,y,z){c.children.sort(z);for(var b=this.toBBox,_=l(c,0,m,b),M=l(c,y-m,y,b),T=x(_)+x(M),B=m;B<y-m;B++){var E=c.children[B];f(_,c.leaf?b(E):E),T+=x(_)}for(var P=y-m-1;P>=m;P--){var X=c.children[P];f(M,c.leaf?b(X):X),T+=x(M)}return T},s.prototype._adjustParentBBoxes=function(c,m,y){for(var z=y;z>=0;z--)f(m[z],c)},s.prototype._condense=function(c){for(var m=c.length-1,y=void 0;m>=0;m--)c[m].children.length===0?m>0?(y=c[m-1].children).splice(y.indexOf(c[m]),1):this.clear():o(c[m],this.toBBox)},s})}}),Li=W(rt()),qt={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"},Wt={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"};function mt(t,r,i){return Math.min(Math.max(t,i),r)}var ut=class extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}};function He(t){if(typeof t!="string")throw new ut(t);if(t.trim().toLowerCase()==="transparent")return[0,0,0,0];let r=t.trim();r=er.test(t)?function(a){let o=a.toLowerCase().trim(),l=Ke[function(f){let u=5381,d=f.length;for(;d;)u=33*u^f.charCodeAt(--d);return(u>>>0)%2341}(o)];if(!l)throw new ut(a);return`#${l}`}(t):t;let i=Je.exec(r);if(i){let a=Array.from(i).slice(1);return[...a.slice(0,3).map(o=>parseInt(wt(o,2),16)),parseInt(wt(a[3]||"f",2),16)/255]}let e=Ge.exec(r);if(e){let a=Array.from(e).slice(1);return[...a.slice(0,3).map(o=>parseInt(o,16)),parseInt(a[3]||"ff",16)/255]}let n=Qe.exec(r);if(n){let a=Array.from(n).slice(1);return[...a.slice(0,3).map(o=>parseInt(o,10)),parseFloat(a[3]||"1")]}let s=tr.exec(r);if(s){let[a,o,l,f]=Array.from(s).slice(1).map(parseFloat);if(mt(0,100,o)!==o)throw new ut(t);if(mt(0,100,l)!==l)throw new ut(t);return[...rr(a,o,l),f||1]}throw new ut(t)}var Nt=t=>parseInt(t.replace(/_/g,""),36),Ke="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((t,r)=>{let i=Nt(r.substring(0,3)),e=Nt(r.substring(3)).toString(16),n="";for(let s=0;s<6-e.length;s++)n+="0";return t[i]=`${n}${e}`,t},{}),wt=(t,r)=>Array.from(Array(r)).map(()=>t).join(""),Je=new RegExp(`^#${wt("([a-f0-9])",3)}([a-f0-9])?$`,"i"),Ge=new RegExp(`^#${wt("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),Qe=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${wt(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),tr=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,er=/^[a-z]+$/i,Zt=t=>Math.round(255*t),rr=(t,r,i)=>{let e=i/100;if(r===0)return[e,e,e].map(Zt);let n=(t%360+360)%360/60,s=(1-Math.abs(2*e-1))*(r/100),a=s*(1-Math.abs(n%2-1)),o=0,l=0,f=0;n>=0&&n<1?(o=s,l=a):n>=1&&n<2?(o=a,l=s):n>=2&&n<3?(l=s,f=a):n>=3&&n<4?(l=a,f=s):n>=4&&n<5?(o=a,f=s):n>=5&&n<6&&(o=s,f=a);let u=e-s/2;return[o+u,l+u,f+u].map(Zt)};function Ht(t){let[r,i,e,n]=He(t).map((f,u)=>u===3?f:f/255),s=Math.max(r,i,e),a=Math.min(r,i,e),o=(s+a)/2;if(s===a)return[0,0,o,n];let l=s-a;return[60*(r===s?(i-e)/l+(i<e?6:0):i===s?(e-r)/l+2:(r-i)/l+4),o>.5?l/(2-s-a):l/(s+a),o,n]}function ir(t,r,i,e){return`hsla(${(t%360).toFixed()}, ${mt(0,100,100*r).toFixed()}%, ${mt(0,100,100*i).toFixed()}%, ${parseFloat(mt(0,1,e).toFixed(3))})`}var J=W(rt()),Fi=W(Re()),nr=W(Oe()),U=class{constructor(t,r){this.str=t??r,this.per_feature=typeof this.str=="function"&&this.str.length===2}get(t,r){return typeof this.str=="function"?this.str(t,r):this.str}},j=class{constructor(t,r=1){this.value=t??r,this.per_feature=typeof this.value=="function"&&this.value.length===2}get(t,r){return typeof this.value=="function"?this.value(t,r):this.value}},Xt=class{constructor(t){var r;this.label_props=(r=t?.label_props)!=null?r:["name"],this.textTransform=t?.textTransform}get(t,r){let i,e;typeof this.label_props=="function"?e=this.label_props(t,r):e=this.label_props;for(let s of e)if(r.props.hasOwnProperty(s)&&typeof r.props[s]=="string"){i=r.props[s];break}let n;return typeof this.textTransform=="function"?n=this.textTransform(t,r):n=this.textTransform,i&&n==="uppercase"?i=i.toUpperCase():i&&n==="lowercase"?i=i.toLowerCase():i&&n==="capitalize"&&(i=i.toLowerCase().split(" ").map(o=>o[0].toUpperCase()+o.slice(1)).join(" ")),i}},Yt=class{constructor(t){var r,i;t?.font?this.font=t.font:(this.family=(r=t?.fontFamily)!=null?r:"sans-serif",this.size=(i=t?.fontSize)!=null?i:12,this.weight=t?.fontWeight,this.style=t?.fontStyle)}get(t,r){if(this.font)return typeof this.font=="function"?this.font(t,r):this.font;let i="";this.style&&(typeof this.style=="function"?i=`${this.style(t,r)} `:i=`${this.style} `);let e="";this.weight&&(typeof this.weight=="function"?e=`${this.weight(t,r)} `:e=`${this.weight} `);let n;typeof this.size=="function"?n=this.size(t,r):n=this.size;let s;return typeof this.family=="function"?s=this.family(t,r):s=this.family,`${i}${e}${n}px ${s}`}},sr=class{constructor(t,r=[]){this.value=t??r,this.per_feature=typeof this.value=="function"&&this.value.length===2}get(t,r){return typeof this.value=="function"?this.value(t,r):this.value}},Kt=W(rt()),ar=(t,r,i)=>{let e=[],n,s,a,o=0,l=0,f=0,u=0,d=0,w=0,x=0,v=0,F=0,k=0,S=0,c=0;if(t.length<2)return[];if(t.length===2)return f=Math.sqrt(N(t[1].x-t[0].x,2)+N(t[1].y-t[0].y,2)),[{length:f,beginIndex:0,beginDistance:0,endIndex:2,endDistance:f}];for(u=Math.sqrt(N(t[1].x-t[0].x,2)+N(t[1].y-t[0].y,2)),o=1,l=t.length-1;o<l;o++)n=t[o-1],s=t[o],a=t[o+1],w=s.x-n.x,x=s.y-n.y,v=a.x-s.x,F=a.y-s.y,d=Math.sqrt(v*v+F*F),f+=u,k=Math.acos((w*v+x*F)/(u*d)),(k>r||f-c>i)&&(e.push({length:f-c,beginDistance:c,beginIndex:S,endIndex:o+1,endDistance:f}),S=o,c=f),u=d;return o-S>0&&e.push({length:f-c+d,beginIndex:S,beginDistance:c,endIndex:o+1,endDistance:f+d}),e};function or(t,r,i,e){let s=[];for(let o of t){let l=ar(o,Math.PI/45,r);for(let f of l)if(f.length>=r+e){let u=new Kt.default(o[f.beginIndex].x,o[f.beginIndex].y),d=o[f.endIndex-1],w=new Kt.default((d.x-u.x)/f.length,(d.y-u.y)/f.length);for(let x=e;x<f.length-r;x+=i)s.push({start:u.add(w.mult(x)),end:u.add(w.mult(x+r))})}}return s}function lr(t,r,i,e){let n=r.x-t.x,s=r.y-t.y,a=Math.sqrt(N(r.x-t.x,2)+N(r.y-t.y,2)),o=[];for(let l=0;l<i+e;l+=2*e){let f=l*1/a;o.push({x:t.x+f*n,y:t.y+f*s})}return o}function de(t,r){if(t.length<=r)return[t];let i=r-1,e=t.lastIndexOf(" ",i),n=t.indexOf(" ",i);if(e===-1&&n===-1)return[t];let s,a;return n===-1||e>=0&&i-e<n-i?(s=t.substring(0,e),a=t.substring(e+1,t.length)):(s=t.substring(0,n),a=t.substring(n+1,t.length)),[s,...de(a,r)]}var hr="\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DB5\u4E00-\u9FEA\uF900-\uFA6D\uFA70-\uFAD9\u2000",Si=new RegExp(`^[${hr}]+$`),gt=W(rt()),fr=W(qe()),ur=W(Ne()),O=(t,r,i)=>new Promise((e,n)=>{var s=l=>{try{o(i.next(l))}catch(f){n(f)}},a=l=>{try{o(i.throw(l))}catch(f){n(f)}},o=l=>l.done?e(l.value):Promise.resolve(l.value).then(s,a);o((i=i.apply(t,r)).next())}),q=Uint8Array,st=Uint16Array,pe=Uint32Array,me=new q([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ye=new q([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cr=new q([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),we=function(t,r){for(var i=new st(31),e=0;e<31;++e)i[e]=r+=1<<t[e-1];for(var n=new pe(i[30]),e=1;e<30;++e)for(var s=i[e];s<i[e+1];++s)n[s]=s-i[e]<<5|e;return[i,n]},ge=we(me,2),xe=ge[0],dr=ge[1];xe[28]=258,dr[258]=28;var ve=we(ye,0),pr=ve[0],Ci=ve[1],St=new st(32768);for(V=0;V<32768;++V)et=(V&43690)>>>1|(V&21845)<<1,et=(et&52428)>>>2|(et&13107)<<2,et=(et&61680)>>>4|(et&3855)<<4,St[V]=((et&65280)>>>8|(et&255)<<8)>>>1;var et,V,yt=function(t,r,i){for(var e=t.length,n=0,s=new st(r);n<e;++n)t[n]&&++s[t[n]-1];var a=new st(r);for(n=0;n<r;++n)a[n]=a[n-1]+s[n-1]<<1;var o;if(i){o=new st(1<<r);var l=15-r;for(n=0;n<e;++n)if(t[n])for(var f=n<<4|t[n],u=r-t[n],d=a[t[n]-1]++<<u,w=d|(1<<u)-1;d<=w;++d)o[St[d]>>>l]=f}else for(o=new st(e),n=0;n<e;++n)t[n]&&(o[n]=St[a[t[n]-1]++]>>>15-t[n]);return o},xt=new q(288);for(V=0;V<144;++V)xt[V]=8;var V;for(V=144;V<256;++V)xt[V]=9;var V;for(V=256;V<280;++V)xt[V]=7;var V;for(V=280;V<288;++V)xt[V]=8;var V,_e=new q(32);for(V=0;V<32;++V)_e[V]=5;var V,mr=yt(xt,9,1),yr=yt(_e,5,1),Mt=function(t){for(var r=t[0],i=1;i<t.length;++i)t[i]>r&&(r=t[i]);return r},Z=function(t,r,i){var e=r/8|0;return(t[e]|t[e+1]<<8)>>(r&7)&i},Lt=function(t,r){var i=r/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(r&7)},wr=function(t){return(t+7)/8|0},gr=function(t,r,i){(r==null||r<0)&&(r=0),(i==null||i>t.length)&&(i=t.length);var e=new(t.BYTES_PER_ELEMENT==2?st:t.BYTES_PER_ELEMENT==4?pe:q)(i-r);return e.set(t.subarray(r,i)),e},xr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],K=function(t,r,i){var e=new Error(r||xr[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,K),!i)throw e;return e},Et=function(t,r,i){var e=t.length;if(!e||i&&i.f&&!i.l)return r||new q(0);var n=!r||i,s=!i||i.i;i||(i={}),r||(r=new q(e*3));var a=function(Pt){var At=r.length;if(Pt>At){var jt=new q(Math.max(At*2,Pt));jt.set(r),r=jt}},o=i.f||0,l=i.p||0,f=i.b||0,u=i.l,d=i.d,w=i.m,x=i.n,v=e*8;do{if(!u){o=Z(t,l,1);var F=Z(t,l+1,3);if(l+=3,F)if(F==1)u=mr,d=yr,w=9,x=5;else if(F==2){var m=Z(t,l,31)+257,y=Z(t,l+10,15)+4,z=m+Z(t,l+5,31)+1;l+=14;for(var b=new q(z),_=new q(19),M=0;M<y;++M)_[cr[M]]=Z(t,l+M*3,7);l+=y*3;for(var T=Mt(_),B=(1<<T)-1,E=yt(_,T,1),M=0;M<z;){var P=E[Z(t,l,B)];l+=P&15;var k=P>>>4;if(k<16)b[M++]=k;else{var X=0,h=0;for(k==16?(h=3+Z(t,l,3),l+=2,X=b[M-1]):k==17?(h=3+Z(t,l,7),l+=3):k==18&&(h=11+Z(t,l,127),l+=7);h--;)b[M++]=X}}var p=b.subarray(0,m),g=b.subarray(m);w=Mt(p),x=Mt(g),u=yt(p,w,1),d=yt(g,x,1)}else K(1);else{var k=wr(l)+4,S=t[k-4]|t[k-3]<<8,c=k+S;if(c>e){s&&K(0);break}n&&a(f+S),r.set(t.subarray(k,c),f),i.b=f+=S,i.p=l=c*8,i.f=o;continue}if(l>v){s&&K(0);break}}n&&a(f+131072);for(var D=(1<<w)-1,C=(1<<x)-1,Y=l;;Y=l){var X=u[Lt(t,l)&D],I=X>>>4;if(l+=X&15,l>v){s&&K(0);break}if(X||K(2),I<256)r[f++]=I;else if(I==256){Y=l,u=null;break}else{var R=I-254;if(I>264){var M=I-257,A=me[M];R=Z(t,l,(1<<A)-1)+xe[M],l+=A}var Q=d[Lt(t,l)&C],nt=Q>>>4;Q||K(3),l+=Q&15;var g=pr[nt];if(nt>3){var A=ye[nt];g+=Lt(t,l)&(1<<A)-1,l+=A}if(l>v){s&&K(0);break}n&&a(f+131072);for(var Vt=f+R;f<Vt;f+=4)r[f]=r[f-g],r[f+1]=r[f+1-g],r[f+2]=r[f+2-g],r[f+3]=r[f+3-g];f=Vt}}i.l=u,i.p=Y,i.b=f,i.f=o,u&&(o=1,i.m=w,i.d=d,i.n=x)}while(!o);return f==r.length?r:gr(r,0,f)},vr=new q(0),_r=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&K(6,"invalid gzip data");var r=t[3],i=10;r&4&&(i+=t[10]|(t[11]<<8)+2);for(var e=(r>>3&1)+(r>>4&1);e>0;e-=!t[i++]);return i+(r&2)},br=function(t){var r=t.length;return(t[r-4]|t[r-3]<<8|t[r-2]<<16|t[r-1]<<24)>>>0},zr=function(t){((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)&&K(6,"invalid zlib data"),t[1]&32&&K(6,"invalid zlib data: preset dictionaries not supported")};function kr(t,r){return Et(t,r)}function Mr(t,r){return Et(t.subarray(_r(t),-8),r||new q(br(t)))}function Lr(t,r){return Et((zr(t),t.subarray(2,-4)),r)}function Ct(t,r){return t[0]==31&&t[1]==139&&t[2]==8?Mr(t,r):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?kr(t,r):Lr(t,r)}var Fr=typeof TextDecoder<"u"&&new TextDecoder,Sr=0;try{Fr.decode(vr,{stream:!0}),Sr=1}catch{}var be=(t,r)=>t*Math.pow(2,r),ct=(t,r)=>Math.floor(t/Math.pow(2,r)),kt=(t,r)=>be(t.getUint16(r+1,!0),8)+t.getUint8(r),ze=(t,r)=>be(t.getUint32(r+2,!0),16)+t.getUint16(r,!0),Cr=(t,r,i,e,n)=>{if(t!=e.getUint8(n))return t-e.getUint8(n);let s=kt(e,n+1);if(r!=s)return r-s;let a=kt(e,n+4);return i!=a?i-a:0},Dr=(t,r,i,e)=>{let n=ke(t,r|128,i,e);return n?{z:r,x:i,y:e,offset:n[0],length:n[1],is_dir:!0}:null},Jt=(t,r,i,e)=>{let n=ke(t,r,i,e);return n?{z:r,x:i,y:e,offset:n[0],length:n[1],is_dir:!1}:null},ke=(t,r,i,e)=>{let n=0,s=t.byteLength/17-1;for(;n<=s;){let a=s+n>>1,o=Cr(r,i,e,t,a*17);if(o>0)n=a+1;else if(o<0)s=a-1;else return[ze(t,a*17+7),t.getUint32(a*17+13,!0)]}return null},Tr=(t,r)=>t.is_dir&&!r.is_dir?1:!t.is_dir&&r.is_dir?-1:t.z!==r.z?t.z-r.z:t.x!==r.x?t.x-r.x:t.y-r.y,Me=(t,r)=>{let i=t.getUint8(r*17);return{z:i&127,x:kt(t,r*17+1),y:kt(t,r*17+4),offset:ze(t,r*17+7),length:t.getUint32(r*17+13,!0),is_dir:i>>7===1}},Gt=t=>{let r=[],i=new DataView(t);for(let e=0;e<i.byteLength/17;e++)r.push(Me(i,e));return Br(r)},Br=t=>{t.sort(Tr);let r=new ArrayBuffer(17*t.length),i=new Uint8Array(r);for(let e=0;e<t.length;e++){let n=t[e],s=n.z;n.is_dir&&(s=s|128),i[e*17]=s,i[e*17+1]=n.x&255,i[e*17+2]=n.x>>8&255,i[e*17+3]=n.x>>16&255,i[e*17+4]=n.y&255,i[e*17+5]=n.y>>8&255,i[e*17+6]=n.y>>16&255,i[e*17+7]=n.offset&255,i[e*17+8]=ct(n.offset,8)&255,i[e*17+9]=ct(n.offset,16)&255,i[e*17+10]=ct(n.offset,24)&255,i[e*17+11]=ct(n.offset,32)&255,i[e*17+12]=ct(n.offset,48)&255,i[e*17+13]=n.length&255,i[e*17+14]=n.length>>8&255,i[e*17+15]=n.length>>16&255,i[e*17+16]=n.length>>24&255}return r},Xr=(t,r)=>{if(t.byteLength<17)return null;let i=t.byteLength/17,e=Me(t,i-1);if(e.is_dir){let n=e.z,s=r.z-n,a=Math.trunc(r.x/(1<<s)),o=Math.trunc(r.y/(1<<s));return{z:n,x:a,y:o}}return null};function Yr(t){return O(this,null,function*(){let r=yield t.getBytes(0,512e3),i=new DataView(r.data),e=i.getUint32(4,!0),n=i.getUint16(8,!0),s=new TextDecoder("utf-8"),a=JSON.parse(s.decode(new DataView(r.data,10,e))),o=0;a.compression==="gzip"&&(o=2);let l=0;"minzoom"in a&&(l=+a.minzoom);let f=0;"maxzoom"in a&&(f=+a.maxzoom);let u=0,d=0,w=0,x=-180,v=-85,F=180,k=85;if(a.bounds){let c=a.bounds.split(",");x=+c[0],v=+c[1],F=+c[2],k=+c[3]}if(a.center){let c=a.center.split(",");u=+c[0],d=+c[1],w=+c[2]}return{specVersion:i.getUint16(2,!0),rootDirectoryOffset:10+e,rootDirectoryLength:n*17,jsonMetadataOffset:10,jsonMetadataLength:e,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:o,tileType:1,minZoom:l,maxZoom:f,minLon:x,minLat:v,maxLon:F,maxLat:k,centerZoom:w,centerLon:u,centerLat:d,etag:r.etag}})}function Er(t,r,i,e,n,s,a){return O(this,null,function*(){let o=yield i.getArrayBuffer(r,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(o=Gt(o));let l=Jt(new DataView(o),e,n,s);if(l){let d=(yield r.getBytes(l.offset,l.length,a)).data,w=new DataView(d);return w.getUint8(0)==31&&w.getUint8(1)==139&&(d=Ct(new Uint8Array(d))),{data:d}}let f=Xr(new DataView(o),{z:e,x:n,y:s});if(f){let u=Dr(new DataView(o),f.z,f.x,f.y);if(u){let d=yield i.getArrayBuffer(r,u.offset,u.length,t);t.specVersion===1&&(d=Gt(d));let w=Jt(new DataView(d),e,n,s);if(w){let v=(yield r.getBytes(w.offset,w.length,a)).data,F=new DataView(v);return F.getUint8(0)==31&&F.getUint8(1)==139&&(v=Ct(new Uint8Array(v))),{data:v}}}}})}var Le={getHeader:Yr,getZxy:Er};function ot(t,r){return(r>>>0)*4294967296+(t>>>0)}function Ir(t,r){let i=r.buf,e,n;if(n=i[r.pos++],e=(n&112)>>4,n<128||(n=i[r.pos++],e|=(n&127)<<3,n<128)||(n=i[r.pos++],e|=(n&127)<<10,n<128)||(n=i[r.pos++],e|=(n&127)<<17,n<128)||(n=i[r.pos++],e|=(n&127)<<24,n<128)||(n=i[r.pos++],e|=(n&1)<<31,n<128))return ot(t,e);throw new Error("Expected varint not more than 10 bytes")}function dt(t){let r=t.buf,i,e;return e=r[t.pos++],i=e&127,e<128||(e=r[t.pos++],i|=(e&127)<<7,e<128)||(e=r[t.pos++],i|=(e&127)<<14,e<128)||(e=r[t.pos++],i|=(e&127)<<21,e<128)?i:(e=r[t.pos],i|=(e&15)<<28,Ir(i,t))}function Vr(t,r,i,e){if(e==0){i==1&&(r[0]=t-1-r[0],r[1]=t-1-r[1]);let n=r[0];r[0]=r[1],r[1]=n}}function Pr(t,r,i){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(r>Math.pow(2,t)-1||i>Math.pow(2,t)-1)throw Error("tile x/y outside zoom level bounds");let e=0,n=0;for(;n<t;)e+=Math.pow(2,n)*Math.pow(2,n),n++;let s=Math.pow(2,t),a=0,o=0,l=0,f=[r,i],u=s/2;for(;u>0;)a=(f[0]&u)>0?1:0,o=(f[1]&u)>0?1:0,l+=u*u*(3*a^o),Vr(u,f,a,o),u=u/2;return e+l}function Fe(t,r){return O(this,null,function*(){if(r===1||r===0)return t;if(r===2)return Ct(new Uint8Array(t));throw Error("Compression method not supported")})}var Ar=127;function jr(t,r){let i=0,e=t.length-1;for(;i<=e;){let n=e+i>>1,s=r-t[n].tileId;if(s>0)i=n+1;else if(s<0)e=n-1;else return t[n]}return e>=0&&(t[e].runLength===0||r-t[e].tileId<t[e].runLength)?t[e]:null}var Rr=class{constructor(t){this.url=t}getKey(){return this.url}getBytes(t,r,i){return O(this,null,function*(){let e;i||(e=new AbortController,i=e.signal);let n=yield fetch(this.url,{signal:i,headers:{Range:"bytes="+t+"-"+(t+r-1)}});if(n.status===416&&t===0){let o=n.headers.get("Content-Range");if(!o||!o.startsWith("bytes */"))throw Error("Missing content-length on 416 response");let l=+o.substr(8);n=yield fetch(this.url,{signal:i,headers:{Range:"bytes=0-"+(l-1)}})}if(n.status>=300)throw Error("Bad response code: "+n.status);let s=n.headers.get("Content-Length");if(n.status===200&&(!s||+s>r))throw e&&e.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield n.arrayBuffer(),etag:n.headers.get("ETag")||void 0,cacheControl:n.headers.get("Cache-Control")||void 0,expires:n.headers.get("Expires")||void 0}})}};function H(t,r){let i=t.getUint32(r+4,!0),e=t.getUint32(r+0,!0);return i*Math.pow(2,32)+e}function $r(t,r){let i=new DataView(t),e=i.getUint8(7);if(e>3)throw Error(`Archive is spec version ${e} but this library supports up to spec version 3`);return{specVersion:e,rootDirectoryOffset:H(i,8),rootDirectoryLength:H(i,16),jsonMetadataOffset:H(i,24),jsonMetadataLength:H(i,32),leafDirectoryOffset:H(i,40),leafDirectoryLength:H(i,48),tileDataOffset:H(i,56),tileDataLength:H(i,64),numAddressedTiles:H(i,72),numTileEntries:H(i,80),numTileContents:H(i,88),clustered:i.getUint8(96)===1,internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,!0)/1e7,minLat:i.getInt32(106,!0)/1e7,maxLon:i.getInt32(110,!0)/1e7,maxLat:i.getInt32(114,!0)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,!0)/1e7,centerLat:i.getInt32(123,!0)/1e7,etag:r}}function Se(t){let r={buf:new Uint8Array(t),pos:0},i=dt(r),e=[],n=0;for(let s=0;s<i;s++){let a=dt(r);e.push({tileId:n+a,offset:0,length:0,runLength:1}),n+=a}for(let s=0;s<i;s++)e[s].runLength=dt(r);for(let s=0;s<i;s++)e[s].length=dt(r);for(let s=0;s<i;s++){let a=dt(r);a===0&&s>0?e[s].offset=e[s-1].offset+e[s-1].length:e[s].offset=a-1}return e}function Or(t){let r=new DataView(t);return r.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):r.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var ht=class extends Error{};function Ur(t,r,i,e){return O(this,null,function*(){let n=yield t.getBytes(0,16384);if(new DataView(n.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Or(n.data)<3)return[yield Le.getHeader(t)];let a=n.data.slice(0,Ar),o=n.etag;e&&n.etag!=e&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+t.getKey()),o=void 0);let l=$r(a,o);if(i){let f=n.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),u=t.getKey()+"|"+(l.etag||"")+"|"+l.rootDirectoryOffset+"|"+l.rootDirectoryLength,d=Se(yield r(f,l.internalCompression));return[l,[u,d.length,d]]}return[l,void 0]})}function qr(t,r,i,e,n){return O(this,null,function*(){let s=yield t.getBytes(i,e);if(n.etag&&n.etag!==s.etag)throw new ht(s.etag);let a=yield r(s.data,n.internalCompression),o=Se(a);if(o.length===0)throw new Error("Empty directory is invalid");return o})}var Wr=class{constructor(t=100,r=!0,i=Fe){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.prefetch=r,this.decompress=i}getHeader(t,r){return O(this,null,function*(){let i=t.getKey();if(this.cache.has(i))return this.cache.get(i).lastUsed=this.counter++,yield this.cache.get(i).data;let e=new Promise((n,s)=>{Ur(t,this.decompress,this.prefetch,r).then(a=>{a[1]&&this.cache.set(a[1][0],{lastUsed:this.counter++,data:Promise.resolve(a[1][2])}),n(a[0]),this.prune()}).catch(a=>{s(a)})});return this.cache.set(i,{lastUsed:this.counter++,data:e}),e})}getDirectory(t,r,i,e){return O(this,null,function*(){let n=t.getKey()+"|"+(e.etag||"")+"|"+r+"|"+i;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;let s=new Promise((a,o)=>{qr(t,this.decompress,r,i,e).then(l=>{a(l),this.prune()}).catch(l=>{o(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:s}),s})}getArrayBuffer(t,r,i,e){return O(this,null,function*(){let n=t.getKey()+"|"+(e.etag||"")+"|"+r+"|"+i;if(this.cache.has(n))return this.cache.get(n).lastUsed=this.counter++,yield this.cache.get(n).data;let s=new Promise((a,o)=>{t.getBytes(r,i).then(l=>{if(e.etag&&e.etag!==l.etag)throw new ht(l.etag);a(l.data),this.cache.has(n),this.prune()}).catch(l=>{o(l)})});return this.cache.set(n,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,r;this.cache.forEach((i,e)=>{i.lastUsed<t&&(t=i.lastUsed,r=e)}),r&&this.cache.delete(r)}}invalidate(t,r){return O(this,null,function*(){this.cache.delete(t.getKey()),yield this.getHeader(t,r)})}},Nr=class{constructor(t,r,i){typeof t=="string"?this.source=new Rr(t):this.source=t,i?this.decompress=i:this.decompress=Fe,r?this.cache=r:this.cache=new Wr}getHeader(){return O(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,r,i,e){return O(this,null,function*(){let n=Pr(t,r,i),s=yield this.cache.getHeader(this.source);if(s.specVersion<3)return Le.getZxy(s,this.source,this.cache,t,r,i,e);if(t<s.minZoom||t>s.maxZoom)return;let a=s.rootDirectoryOffset,o=s.rootDirectoryLength;for(let l=0;l<=3;l++){let f=yield this.cache.getDirectory(this.source,a,o,s),u=jr(f,n);if(u)if(u.runLength>0){let d=yield this.source.getBytes(s.tileDataOffset+u.offset,u.length,e);if(s.etag&&s.etag!==d.etag)throw new ht(d.etag);return{data:yield this.decompress(d.data,s.tileCompression),cacheControl:d.cacheControl,expires:d.expires}}else a=s.leafDirectoryOffset+u.offset,o=u.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,r,i,e){return O(this,null,function*(){try{return yield this.getZxyAttempt(t,r,i,e)}catch(n){if(n instanceof ht)return this.cache.invalidate(this.source,n.message),yield this.getZxyAttempt(t,r,i,e);throw n}})}getMetadataAttempt(){return O(this,null,function*(){let t=yield this.cache.getHeader(this.source),r=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength);if(t.etag&&t.etag!==r.etag)throw new ht(r.etag);let i=yield this.decompress(r.data,t.internalCompression),e=new TextDecoder("utf-8");return JSON.parse(e.decode(i))})}getMetadata(){return O(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof ht)return this.cache.invalidate(this.source,t.message),yield this.getMetadataAttempt();throw t}})}};function at(t){return`${t.x}:${t.y}:${t.z}`}var Zr=(t,r,i)=>{t.pos=r;let e=t.readVarint()+t.pos,n=1,s=0,a=0,o=0,l=1/0,f=-1/0,u=1/0,d=-1/0,w=[],x=[];for(;t.pos<e;){if(s<=0){let v=t.readVarint();n=v&7,s=v>>3}if(s--,n===1||n===2)a+=t.readSVarint()*i,o+=t.readSVarint()*i,a<l&&(l=a),a>f&&(f=a),o<u&&(u=o),o>d&&(d=o),n===1&&(x.length>0&&w.push(x),x=[]),x.push(new gt.default(a,o));else if(n===7)x&&x.push(x[0].clone());else throw new Error(`unknown command ${n}`)}return x&&w.push(x),{geom:w,bbox:{minX:l,minY:u,maxX:f,maxY:d}}};function Ce(t,r){let i=new fr.VectorTile(new ur.default(t)),e=new Map;for(let[n,s]of Object.entries(i.layers)){let a=[],o=s;for(let l=0;l<o.length;l++){let f=Zr(o.feature(l)._pbf,o.feature(l)._geometry,r/o.extent),u=0;for(let d of f.geom)u+=d.length;a.push({id:o.feature(l).id,geomType:o.feature(l).type,geom:f.geom,numVertices:u,bbox:f.bbox,props:o.feature(l).properties})}e.set(n,a)}return e}var Qt=class{constructor(t,r){typeof t=="string"?this.p=new Nr(t):this.p=t,this.zoomaborts=[],this.shouldCancelZooms=r}get(t,r){return ft(this,null,function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter(s=>s.z!==t.z?(s.controller.abort(),!1):!0));let i=new AbortController;this.zoomaborts.push({z:t.z,controller:i});let e=i.signal,n=yield this.p.getZxy(t.z,t.x,t.y,e);return n?Ce(n.data,r):new Map})}},Hr=class{constructor(t,r){this.url=t,this.zoomaborts=[],this.shouldCancelZooms=r}get(t,r){return ft(this,null,function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter(s=>s.z!==t.z?(s.controller.abort(),!1):!0));let i=this.url.replace("{z}",t.z.toString()).replace("{x}",t.x.toString()).replace("{y}",t.y.toString()),e=new AbortController;this.zoomaborts.push({z:t.z,controller:e});let n=e.signal;return new Promise((s,a)=>{fetch(i,{signal:n}).then(o=>o.arrayBuffer()).then(o=>{let l=Ce(o,r);s(l)}).catch(o=>{a(o)})})})}},Dt=6378137,te=85.0511287798,vt=Dt*Math.PI,Kr=t=>{let r=Math.PI/180,i=Math.max(Math.min(te,t[0]),-te),e=Math.sin(i*r);return new gt.default(Dt*t[1]*r,Dt*Math.log((1+e)/(1-e))/2)};function ee(t){return t*t}function zt(t,r){return ee(t.x-r.x)+ee(t.y-r.y)}function Jr(t,r,i){let e=zt(r,i);if(e===0)return zt(t,r);let n=((t.x-r.x)*(i.x-r.x)+(t.y-r.y)*(i.y-r.y))/e;return n=Math.max(0,Math.min(1,n)),zt(t,new gt.default(r.x+n*(i.x-r.x),r.y+n*(i.y-r.y)))}function re(t,r){let i=!1;for(let e=0,n=r.length-1;e<r.length;n=e++){let s=r[e].x,a=r[e].y,o=r[n].x,l=r[n].y;a>t.y!=l>t.y&&t.x<(o-s)*(t.y-a)/(l-a)+s&&(i=!i)}return i}function Gr(t){let r=0;for(let i=0;i<t.length;i++){let e=(i+1)%t.length;r+=t[i].x*t[e].y,r-=t[e].x*t[i].y}return r<0}function Qr(t,r){let i=!1;for(let e of r)if(Gr(e))re(t,e)&&(i=!1);else{if(i)return!0;re(t,e)&&(i=!0)}return i}function ti(t,r){let i=1/0;for(let e of r){let n=Math.sqrt(zt(t,e[0]));n<i&&(i=n)}return i}function ei(t,r){let i=1/0;for(let e of r)for(let n=0;n<e.length-1;n++){let s=Math.sqrt(Jr(t,e[n],e[n+1]));s<i&&(i=s)}return i}var ri=class{constructor(t,r){this.source=t,this.cache=new Map,this.inflight=new Map,this.tileSize=r}queryFeatures(t,r,i,e){let n=Kr([r,t]),s=new gt.default((n.x+vt)/(vt*2),1-(n.y+vt)/(vt*2));s.x>1&&(s.x=s.x-Math.floor(s.x));let a=s.mult(1<<i),o=Math.floor(a.x),l=Math.floor(a.y),f=at({z:i,x:o,y:l}),u=[],d=this.cache.get(f);if(d){let w=new gt.default((a.x-o)*this.tileSize,(a.y-l)*this.tileSize);for(let[x,v]of d.data.entries())for(let F of v)F.geomType===1?ti(w,F.geom)<e&&u.push({feature:F,layerName:x}):F.geomType===2?ei(w,F.geom)<e&&u.push({feature:F,layerName:x}):Qr(w,F.geom)&&u.push({feature:F,layerName:x})}return u}get(t){return ft(this,null,function*(){let r=at(t);return new Promise((i,e)=>{let n=this.cache.get(r);if(n)n.used=performance.now(),i(n.data);else{let s=this.inflight.get(r);s?s.push([i,e]):(this.inflight.set(r,[]),this.source.get(t,this.tileSize).then(a=>{this.cache.set(r,{used:performance.now(),data:a});let o=this.inflight.get(r);if(o)for(let l of o)l[0](a);if(this.inflight.delete(r),i(a),this.cache.size>=64){let l=1/0,f;this.cache.forEach((u,d)=>{u.used<l&&(l=u.used,f=d)}),f&&this.cache.delete(f)}}).catch(a=>{let o=this.inflight.get(r);if(o)for(let l of o)l[1](a);this.inflight.delete(r),e(a)}))}})})}},De=5400;var $=class{constructor(t){var r;this.pattern=t.pattern,this.fill=new U(t.fill,"black"),this.opacity=new j(t.opacity,1),this.stroke=new U(t.stroke,"black"),this.width=new j(t.width,0),this.per_feature=(r=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||t.per_feature)!=null?r:!1,this.do_stroke=!1}before(t,r){if(!this.per_feature){t.globalAlpha=this.opacity.get(r),t.fillStyle=this.fill.get(r),t.strokeStyle=this.stroke.get(r);let i=this.width.get(r);i>0&&(this.do_stroke=!0),t.lineWidth=i}if(this.pattern){let i=t.createPattern(this.pattern,"repeat");i&&(t.fillStyle=i)}}draw(t,r,i,e){let n=!1;if(this.per_feature){t.globalAlpha=this.opacity.get(i,e),t.fillStyle=this.fill.get(i,e);let o=this.width.get(i,e);o&&(n=!0,t.strokeStyle=this.stroke.get(i,e),t.lineWidth=o)}let s=()=>{t.fill(),(n||this.do_stroke)&&t.stroke()},a=0;t.beginPath();for(let o of r){a+o.length>De&&(s(),a=0,t.beginPath());for(let l=0;l<o.length;l++){let f=o[l];l===0?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y)}a+=o.length}a>0&&s()}};function ii(t,r){let i=0;for(;r[i+1][0]<t;)i++;return i}function ni(t,r,i){return t*(i-r)+r}function si(t,r,i,e){let n=e[r+1][0]-e[r][0],s=t-e[r][0];return n===0?0:i===1?s/n:(N(i,s)-1)/(N(i,n)-1)}function it(t,r){return i=>{if(r.length<1)return 0;if(i<=r[0][0])return r[0][1];if(i>=r[r.length-1][0])return r[r.length-1][1];let e=ii(i,r),n=si(i,e,t,r);return ni(n,r[e][1],r[e+1][1])}}var tt=class{constructor(t){var r;this.color=new U(t.color,"black"),this.width=new j(t.width),this.opacity=new j(t.opacity),this.dash=t.dash?new sr(t.dash):null,this.dashColor=new U(t.dashColor,"black"),this.dashWidth=new j(t.dashWidth,1),this.lineCap=new U(t.lineCap,"butt"),this.lineJoin=new U(t.lineJoin,"miter"),this.skip=!1,this.per_feature=!!((r=this.dash)!=null&&r.per_feature||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||t.per_feature)}before(t,r){this.per_feature||(t.strokeStyle=this.color.get(r),t.lineWidth=this.width.get(r),t.globalAlpha=this.opacity.get(r),t.lineCap=this.lineCap.get(r),t.lineJoin=this.lineJoin.get(r))}draw(t,r,i,e){if(this.skip)return;let n=()=>{this.per_feature&&(t.globalAlpha=this.opacity.get(i,e),t.lineCap=this.lineCap.get(i,e),t.lineJoin=this.lineJoin.get(i,e)),this.dash?(t.save(),this.per_feature?(t.lineWidth=this.dashWidth.get(i,e),t.strokeStyle=this.dashColor.get(i,e),t.setLineDash(this.dash.get(i,e))):t.setLineDash(this.dash.get(i)),t.stroke(),t.restore()):(t.save(),this.per_feature&&(t.lineWidth=this.width.get(i,e),t.strokeStyle=this.color.get(i,e)),t.stroke(),t.restore())},s=0;t.beginPath();for(let a of r){s+a.length>De&&(n(),s=0,t.beginPath());for(let o=0;o<a.length;o++){let l=a[o];o===0?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y)}s+=a.length}s>0&&n()}};var Tt=class{constructor(t){this.radius=new j(t.radius,3),this.fill=new U(t.fill,"black"),this.stroke=new U(t.stroke,"white"),this.width=new j(t.width,0),this.opacity=new j(t.opacity)}draw(t,r,i,e){t.globalAlpha=this.opacity.get(i,e);let n=this.radius.get(i,e),s=this.width.get(i,e);s>0&&(t.strokeStyle=this.stroke.get(i,e),t.lineWidth=s,t.beginPath(),t.arc(r[0][0].x,r[0][0].y,n+s/2,0,2*Math.PI),t.stroke()),t.fillStyle=this.fill.get(i,e),t.beginPath(),t.arc(r[0][0].x,r[0][0].y,n,0,2*Math.PI),t.fill()}place(t,r,i){let e=r[0],n=new J.default(r[0][0].x,r[0][0].y),s=this.radius.get(t.zoom,i),a={minX:n.x-s,minY:n.y-s,maxX:n.x+s,maxY:n.y+s};return[{anchor:n,bboxes:[a],draw:l=>{this.draw(l,[[new J.default(0,0)]],t.zoom,i)}}]}},ai=class{constructor(t){this.font=new Yt(t),this.text=new Xt(t),this.fill=new U(t.fill,"black"),this.background=new U(t.background,"white"),this.padding=new j(t.padding,0)}place(t,r,i){let e=this.text.get(t.zoom,i);if(!e)return;let n=this.font.get(t.zoom,i);t.scratch.font=n;let s=t.scratch.measureText(e),a=s.width,o=s.actualBoundingBoxAscent,l=s.actualBoundingBoxDescent,f=r[0],u=new J.default(r[0][0].x,r[0][0].y),d=this.padding.get(t.zoom,i),w={minX:u.x-a/2-d,minY:u.y-o-d,maxX:u.x+a/2+d,maxY:u.y+l+d};return[{anchor:u,bboxes:[w],draw:v=>{v.globalAlpha=1,v.fillStyle=this.background.get(t.zoom,i),v.fillRect(-a/2-d,-o-d,a+2*d,o+l+2*d),v.fillStyle=this.fill.get(t.zoom,i),v.font=n,v.fillText(e,-a/2,0)}}]}},ie=class{constructor(t){this.list=t}place(t,r,i){let e=this.list[0].place(t,r,i);if(!e)return;let n=e[0],s=n.anchor,a=n.bboxes[0],o=a.maxY-a.minY,l=[{draw:n.draw,translate:{x:0,y:0}}],f=[[new J.default(r[0][0].x,r[0][0].y+o)]];for(let d=1;d<this.list.length;d++)e=this.list[d].place(t,f,i),e&&(n=e[0],a=Te(a,n.bboxes[0]),l.push({draw:n.draw,translate:{x:0,y:o}}));return[{anchor:s,bboxes:[a],draw:d=>{for(let w of l)d.save(),d.translate(w.translate.x,w.translate.y),w.draw(d),d.restore()}}]}},Te=(t,r)=>({minX:Math.min(t.minX,r.minX),minY:Math.min(t.minY,r.minY),maxX:Math.max(t.maxX,r.maxX),maxY:Math.max(t.maxY,r.maxY)}),ne=class{constructor(t){this.list=t}place(t,r,i){let e=this.list[0];if(!e)return;let n=e.place(t,r,i);if(!n)return;let s=n[0],a=s.anchor,o=s.bboxes[0],l=[s.draw];for(let u=1;u<this.list.length;u++){if(n=this.list[u].place(t,r,i),!n)return;s=n[0],o=Te(o,s.bboxes[0]),l.push(s.draw)}return[{anchor:a,bboxes:[o],draw:u=>{for(let d of l)d(u)}}]}},oi=class{constructor(t){this.symbolizer=t}place(t,r,i){let e=r[0][0],n=this.symbolizer.place(t,[[new J.default(0,0)]],i);if(!n||n.length===0)return;let s=n[0],a=s.bboxes[0],o=a.maxX-a.minX,l=a.maxY-a.minY,f={minX:e.x-o/2,maxX:e.x+o/2,minY:e.y-l/2,maxY:e.y+l/2};return[{anchor:e,bboxes:[f],draw:d=>{d.translate(-o/2,l/2-a.maxY),s.draw(d,{justify:2})}}]}};var It=class{constructor(t){this.font=new Yt(t),this.text=new Xt(t),this.fill=new U(t.fill,"black"),this.stroke=new U(t.stroke,"black"),this.width=new j(t.width,0),this.lineHeight=new j(t.lineHeight,1),this.letterSpacing=new j(t.letterSpacing,0),this.maxLineCodeUnits=new j(t.maxLineChars,15),this.justify=t.justify}place(t,r,i){let e=this.text.get(t.zoom,i);if(!e)return;let n=this.font.get(t.zoom,i);t.scratch.font=n;let s=this.letterSpacing.get(t.zoom,i),a=de(e,this.maxLineCodeUnits.get(t.zoom,i)),o="",l=0;for(let S of a)S.length>l&&(l=S.length,o=S);let f=t.scratch.measureText(o),u=f.width+s*(l-1),d=f.actualBoundingBoxAscent,w=f.actualBoundingBoxDescent,x=(d+w)*this.lineHeight.get(t.zoom,i),v=new J.default(r[0][0].x,r[0][0].y),F={minX:v.x,minY:v.y-d,maxX:v.x+u,maxY:v.y+w+(a.length-1)*x};return[{anchor:v,bboxes:[F],draw:(S,c)=>{S.globalAlpha=1,S.font=n,S.fillStyle=this.fill.get(t.zoom,i);let m=this.width.get(t.zoom,i),y=0;for(let z of a){let b=0;if(this.justify===2||c&&c.justify===2?b=(u-S.measureText(z).width)/2:(this.justify===3||c&&c.justify===3)&&(b=u-S.measureText(z).width),m)if(S.lineWidth=m*2,S.strokeStyle=this.stroke.get(t.zoom,i),s>0){let _=b;for(let M of z)S.strokeText(M,_,y),_+=S.measureText(M).width+s}else S.strokeText(z,b,y);if(s>0){let _=b;for(let M of z)S.fillText(M,_,y),_+=S.measureText(M).width+s}else S.fillText(z,b,y);y+=x}}}]}},pt=class{constructor(t){this.centered=new oi(new It(t))}place(t,r,i){return this.centered.place(t,r,i)}},li=class{constructor(t,r){var i,e,n;this.symbolizer=t,this.offsetX=new j(r.offsetX,0),this.offsetY=new j(r.offsetY,0),this.justify=(i=r.justify)!=null?i:void 0,this.placements=(e=r.placements)!=null?e:[2,6,8,4,1,3,5,7],this.ddValues=(n=r.ddValues)!=null?n:()=>({})}place(t,r,i){if(i.geomType!==1)return;let e=r[0][0],n=this.symbolizer.place(t,[[new J.default(0,0)]],i);if(!n||n.length===0)return;let s=n[0],a=s.bboxes[0],o=this.offsetX,l=this.offsetY,f=this.justify,u=this.placements,{offsetX:d,offsetY:w,justify:x,placements:v}=this.ddValues(t.zoom,i)||{};d&&(o=new j(d,0)),w&&(l=new j(w,0)),x&&(f=x),v&&(u=v);let F=o.get(t.zoom,i),k=l.get(t.zoom,i),S=(b,_)=>({minX:b.x+_.x+a.minX,minY:b.y+_.y+a.minY,maxX:b.x+_.x+a.maxX,maxY:b.y+_.y+a.maxY}),c=new J.default(F,k),m,y=b=>{b.translate(c.x,c.y),s.draw(b,{justify:m})},z=(b,_)=>{let M=S(b,_);if(!t.index.bboxCollides(M,t.order))return[{anchor:e,bboxes:[M],draw:y}]};for(let b of u){let _=this.computeXAxisOffset(F,a,b),M=this.computeYAxisOffset(k,a,b);return m=this.computeJustify(f,b),c=new J.default(_,M),z(e,c)}}computeXAxisOffset(t,r,i){let e=r.maxX,n=e/2;return[1,5].includes(i)?t-n:[8,7,6].includes(i)?t-e:t}computeYAxisOffset(t,r,i){let e=Math.abs(r.minY),n=r.maxY,s=(r.minY+r.maxY)/2;return[3,7].includes(i)?t-s:[8,2,1].includes(i)?t-n:[6,4,5].includes(i)?t+e:t}computeJustify(t,r){return t||([1,5].includes(r)?2:[2,3,4].includes(r)?1:3)}},_t=class{constructor(t){this.symbolizer=new li(new It(t),t)}place(t,r,i){return this.symbolizer.place(t,r,i)}};var hi=class{constructor(t){var r;this.font=new Yt(t),this.text=new Xt(t),this.fill=new U(t.fill,"black"),this.stroke=new U(t.stroke,"black"),this.width=new j(t.width,0),this.offset=new j(t.offset,0),this.position=(r=t.position)!=null?r:1,this.maxLabelCodeUnits=new j(t.maxLabelChars,40),this.repeatDistance=new j(t.repeatDistance,250)}place(t,r,i){let e=this.text.get(t.zoom,i);if(!e||e.length>this.maxLabelCodeUnits.get(t.zoom,i))return;let n=20,s=i.bbox;if(s.maxY-s.minY<n&&s.maxX-s.minX<n)return;let a=this.font.get(t.zoom,i);t.scratch.font=a;let o=t.scratch.measureText(e),l=o.width,f=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent,u=this.repeatDistance.get(t.zoom,i);t.overzoom>4&&(u*=1<<t.overzoom-4);let d=f*2,w=or(r,l,u,d);if(w.length===0)return;let x=[];for(let v of w){let F=v.end.x-v.start.x,k=v.end.y-v.start.y,c=lr(v.start,v.end,l,d/2).map(y=>({minX:y.x-d/2,minY:y.y-d/2,maxX:y.x+d/2,maxY:y.y+d/2})),m=y=>{y.globalAlpha=1,y.rotate(Math.atan2(k,F)),F<0&&(y.scale(-1,-1),y.translate(-l,0));let z=0;this.position===3?z+=f:this.position===2&&(z+=f/2),y.translate(0,z-this.offset.get(t.zoom,i)),y.font=a;let b=this.width.get(t.zoom,i);b&&(y.lineWidth=b,y.strokeStyle=this.stroke.get(t.zoom,i),y.strokeText(e,0,0)),y.fillStyle=this.fill.get(t.zoom,i),y.fillText(e,0,0)};x.push({anchor:v.start,bboxes:c,draw:m,deduplicationKey:e,deduplicationDistance:u})}return x}},Ft=class{constructor(t){this.symbolizer=new It(t)}place(t,r,i){let e=i.bbox;if((e.maxY-e.minY)*(e.maxX-e.minX)<2e4)return;let s=this.symbolizer.place(t,[[new J.default(0,0)]],i);if(!s||s.length===0)return;let a=s[0],o=a.bboxes[0],l=r[0],f=(0,nr.default)([l.map(x=>[x.x,x.y])]),u=new J.default(f[0],f[1]),d={minX:u.x-(o.maxX-o.minX)/2,minY:u.y-(o.maxY-o.minY)/2,maxX:u.x+(o.maxX-o.minX)/2,maxY:u.y+(o.maxY-o.minY)/2};return[{anchor:u,bboxes:[d],draw:x=>{x.translate(a.anchor.x-(o.maxX-o.minX)/2,a.anchor.y),a.draw(x)}}]}},Be=(t,r)=>{let i=Ht(r),e=Ae({},t);for(let[n,s]of Object.entries(t)){let a=Ht(s);e[n]=ir(i[0],i[1],a[2],a[3])}return e},se=(t,r)=>{let i=t;return r&&(i=Be(t,r)),[{dataLayer:"earth",symbolizer:new $({fill:i.earth})},{dataLayer:"natural",symbolizer:new $({fill:i.glacier}),filter:(e,n)=>n.props.natural==="glacier"},{dataLayer:"landuse",symbolizer:new $({fill:i.residential}),filter:(e,n)=>n.props.landuse==="residential"||n.props.place==="neighbourhood"},{dataLayer:"landuse",symbolizer:new $({fill:i.hospital}),filter:(e,n)=>n.props.amenity==="hospital"},{dataLayer:"landuse",symbolizer:new $({fill:i.cemetery}),filter:(e,n)=>n.props.landuse==="cemetery"},{dataLayer:"landuse",symbolizer:new $({fill:i.school}),filter:(e,n)=>n.props.amenity==="school"||n.props.amenity==="kindergarten"||n.props.amenity==="university"||n.props.amenity==="college"},{dataLayer:"landuse",symbolizer:new $({fill:i.industrial}),filter:(e,n)=>n.props.landuse==="industrial"},{dataLayer:"natural",symbolizer:new $({fill:i.wood}),filter:(e,n)=>n.props.natural==="wood"},{dataLayer:"landuse",symbolizer:new $({fill:i.grass}),filter:(e,n)=>n.props.landuse==="grass"},{dataLayer:"landuse",symbolizer:new $({fill:i.park}),filter:(e,n)=>n.props.leisure==="park"},{dataLayer:"water",symbolizer:new $({fill:i.water})},{dataLayer:"natural",symbolizer:new $({fill:i.sand}),filter:(e,n)=>n.props.natural==="sand"},{dataLayer:"buildings",symbolizer:new $({fill:i.buildings})},{dataLayer:"roads",symbolizer:new tt({color:i.highwayCasing,width:it(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(e,n)=>n.props["pmap:kind"]==="highway"},{dataLayer:"roads",symbolizer:new tt({color:i.majorRoadCasing,width:it(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(e,n)=>n.props["pmap:kind"]==="major_road"},{dataLayer:"roads",symbolizer:new tt({color:i.mediumRoadCasing,width:it(1.4,[[13,3],[17,6],[20,18]])}),filter:(e,n)=>n.props["pmap:kind"]==="medium_road"},{dataLayer:"roads",symbolizer:new tt({color:i.minorRoadCasing,width:it(1.4,[[14,2],[17,5],[20,15]])}),filter:(e,n)=>n.props["pmap:kind"]==="minor_road"},{dataLayer:"roads",symbolizer:new tt({color:i.minorRoad,width:it(1.4,[[14,1],[17,3],[20,13]])}),filter:(e,n)=>n.props["pmap:kind"]==="minor_road"},{dataLayer:"roads",symbolizer:new tt({color:i.mediumRoad,width:it(1.4,[[13,2],[17,4],[20,15]])}),filter:(e,n)=>n.props["pmap:kind"]==="medium_road"},{dataLayer:"roads",symbolizer:new tt({color:i.majorRoad,width:it(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(e,n)=>n.props["pmap:kind"]==="major_road"},{dataLayer:"roads",symbolizer:new tt({color:i.highway,width:it(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(e,n)=>n.props["pmap:kind"]==="highway"},{dataLayer:"boundaries",symbolizer:new tt({color:i.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new $({fill:i.mask})}]},ae=(t,r,i,e)=>{let n=t;r&&(n=Be(t,r));let s=["name"];i&&(s=i);let a=(o,l)=>e?o instanceof _t?new ie([o,new _t({fill:l,label_props:e})]):new ie([o,new pt({fill:l,label_props:e})]):o;return[{dataLayer:"places",symbolizer:a(new pt({label_props:s,fill:n.countryLabel,lineHeight:1.5,font:(o,l)=>o<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),n.countryLabel),filter:(o,l)=>l.props["pmap:kind"]==="country"},{dataLayer:"places",symbolizer:a(new pt({label_props:s,fill:n.stateLabel,font:"300 16px sans-serif"}),n.stateLabel),filter:(o,l)=>l.props["pmap:kind"]==="state"},{id:"cities_high",dataLayer:"places",filter:(o,l)=>l.props["pmap:kind"]==="city",minzoom:7,symbolizer:a(new pt({label_props:s,fill:n.cityLabel,font:(o,l)=>l?.props["pmap:rank"]===1?o>8?"600 20px sans-serif":"600 12px sans-serif":o>8?"600 16px sans-serif":"600 10px sans-serif"}),n.cityLabel),sort:(o,l)=>o["pmap:rank"]-l["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(o,l)=>l.props["pmap:kind"]==="city",maxzoom:6,symbolizer:new ne([new Tt({radius:2,fill:n.cityLabel}),a(new _t({label_props:s,fill:n.cityLabel,offsetX:2,offsetY:2,font:(o,l)=>l?.props["pmap:rank"]===1?o>8?"600 20px sans-serif":"600 12px sans-serif":o>8?"600 16px sans-serif":"600 10px sans-serif"}),n.cityLabel)]),sort:(o,l)=>o["pmap:rank"]-l["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:a(new pt({label_props:s,fill:n.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),n.neighbourhoodLabel),filter:(o,l)=>l.props["pmap:kind"]==="neighbourhood"},{dataLayer:"landuse",symbolizer:a(new Ft({label_props:s,fill:n.landuseLabel,font:"300 12px sans-serif"}),n.landuseLabel)},{dataLayer:"water",symbolizer:a(new Ft({label_props:s,fill:n.waterLabel,font:"italic 600 12px sans-serif"}),n.waterLabel)},{dataLayer:"natural",symbolizer:a(new Ft({label_props:s,fill:n.naturalLabel,font:"italic 300 12px sans-serif"}),n.naturalLabel)},{dataLayer:"roads",symbolizer:a(new hi({label_props:s,fill:n.roadsLabel,font:"500 12px sans-serif"}),n.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new ai({label_props:["ref"],font:"600 9px sans-serif",background:n.highway,padding:2,fill:n.neighbourhoodLabel}),filter:(o,l)=>l.props["pmap:kind"]==="highway"},{dataLayer:"pois",symbolizer:new ne([new Tt({radius:2,fill:n.poisLabel}),a(new _t({label_props:s,fill:n.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),n.poisLabel)])}]},fi=W(rt()),ui=W(Ze()),lt=W(rt()),Xe=(t,r,i)=>{let e=[];for(let n of t){let s=[];for(let a of n)s.push(a.clone().mult(r).add(i));e.push(s)}return e},bt=(t,r)=>{let i=1<<r;return t<0?i+t:t>=i?t%i:t},ci=class{constructor(t,r,i){this.tileCache=t,this.maxDataLevel=r,this.levelDiff=i}dataTilesForBounds(t,r){let i=N(2,t)/N(2,Math.ceil(t)),e=[],n=1,s=this.tileCache.tileSize;if(t<this.levelDiff)n=1/(1<<this.levelDiff-t)*i,e.push({data_tile:{z:0,x:0,y:0},origin:new lt.default(0,0),scale:n,dim:s*n});else if(t<=this.levelDiff+this.maxDataLevel){let a=1<<this.levelDiff,o=256*i,l=Math.ceil(t)-this.levelDiff,f=Math.floor(r.minX/a/o),u=Math.floor(r.minY/a/o),d=Math.floor(r.maxX/a/o),w=Math.floor(r.maxY/a/o);for(let x=f;x<=d;x++)for(let v=u;v<=w;v++){let F=new lt.default(x*a*o,v*a*o);e.push({data_tile:{z:l,x:bt(x,l),y:bt(v,l)},origin:F,scale:i,dim:s*i})}}else{let a=1<<this.levelDiff;n=(1<<Math.ceil(t)-this.maxDataLevel-this.levelDiff)*i;let o=Math.floor(r.minX/a/256/n),l=Math.floor(r.minY/a/256/n),f=Math.floor(r.maxX/a/256/n),u=Math.floor(r.maxY/a/256/n);for(let d=o;d<=f;d++)for(let w=l;w<=u;w++){let x=new lt.default(d*a*256*n,w*a*256*n);e.push({data_tile:{z:this.maxDataLevel,x:bt(d,this.maxDataLevel),y:bt(w,this.maxDataLevel)},origin:x,scale:n,dim:s*n})}}return e}dataTileForDisplayTile(t){let r,i=1,e=this.tileCache.tileSize,n;if(t.z<this.levelDiff)r={z:0,x:0,y:0},i=1/(1<<this.levelDiff-t.z),n=new lt.default(0,0),e=e*i;else if(t.z<=this.levelDiff+this.maxDataLevel){let s=1<<this.levelDiff;r={z:t.z-this.levelDiff,x:Math.floor(t.x/s),y:Math.floor(t.y/s)},n=new lt.default(r.x*s*256,r.y*s*256)}else{i=1<<t.z-this.maxDataLevel-this.levelDiff;let s=1<<this.levelDiff;r={z:this.maxDataLevel,x:Math.floor(t.x/s/i),y:Math.floor(t.y/s/i)},n=new lt.default(r.x*s*i*256,r.y*s*i*256),e=e*i}return{data_tile:r,scale:i,origin:n,dim:e}}getBbox(t,r){return ft(this,null,function*(){let i=this.dataTilesForBounds(t,r);return(yield Promise.all(i.map(n=>this.tileCache.get(n.data_tile)))).map((n,s)=>{let a=i[s];return{data:n,z:t,data_tile:a.data_tile,scale:a.scale,dim:a.dim,origin:a.origin}})})}getDisplayTile(t){return ft(this,null,function*(){let r=this.dataTileForDisplayTile(t);return{data:yield this.tileCache.get(r.data_tile),z:t.z,data_tile:r.data_tile,scale:r.scale,origin:r.origin,dim:r.dim}})}queryFeatures(t,r,i){let e=Math.round(i),n=Math.min(e-this.levelDiff,this.maxDataLevel),s=16/(1<<e-n);return this.tileCache.queryFeatures(t,r,n,s)}},di=t=>{let r=e=>{let n=e.levelDiff===void 0?2:e.levelDiff,s=e.maxDataZoom||14,a;typeof e.url=="string"?e.url.endsWith(".pmtiles")?a=new Qt(e.url,!0):a=new Hr(e.url,!0):a=new Qt(e.url,!0);let o=new ri(a,256*1<<n);return new ci(o,s,n)},i=new Map;if(t.sources)for(let e in t.sources)i.set(e,r(t.sources[e]));else i.set("",r(t));return i},pi=(t,r,i)=>{let n=r/256,s=Math.floor(i.minX/256),a=Math.floor(i.minY/256),o=Math.floor(i.maxX/256),l=Math.floor(i.maxY/256),f=Math.log2(n),u=[];for(let d=s;d<=o;d++){let w=d%(1<<t);for(let x=a;x<=l;x++)u.push({display:at({z:t,x:w,y:x}),key:at({z:t-f,x:Math.floor(w/n),y:Math.floor(x/n)})})}return u},mi=class{constructor(t,r){this.tree=new ui.default,this.current=new Map,this.dim=t,this.maxLabeledTiles=r}hasPrefix(t){for(let r of this.current.keys())if(r.startsWith(t))return!0;return!1}has(t){return this.current.has(t)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(t,r){let i=new Set;for(let e of this.tree.search(t))e.indexedLabel.order<=r&&i.add(e.indexedLabel);return i}searchLabel(t,r){let i=new Set;for(let e of t.bboxes)for(let n of this.tree.search(e))n.indexedLabel.order<=r&&i.add(n.indexedLabel);return i}bboxCollides(t,r){for(let i of this.tree.search(t))if(i.indexedLabel.order<=r)return!0;return!1}labelCollides(t,r){for(let i of t.bboxes)for(let e of this.tree.search(i))if(e.indexedLabel.order<=r)return!0;return!1}deduplicationCollides(t){if(!t.deduplicationKey||!t.deduplicationDistance)return!1;let r=t.deduplicationDistance,i={minX:t.anchor.x-r,minY:t.anchor.y-r,maxX:t.anchor.x+r,maxY:t.anchor.y+r};for(let e of this.tree.search(i))if(e.indexedLabel.deduplicationKey===t.deduplicationKey&&e.indexedLabel.anchor.dist(t.anchor)<r)return!0;return!1}makeEntry(t){this.current.get(t)&&console.log("consistency error 1");let r=new Set;this.current.set(t,r)}insert(t,r,i){let e={anchor:t.anchor,bboxes:t.bboxes,draw:t.draw,order:r,tileKey:i,deduplicationKey:t.deduplicationKey,deduplicationDistance:t.deduplicationDistance},n=this.current.get(i);if(!n){let o=new Set;this.current.set(i,o),n=o}n.add(e);let s=!1,a=!1;for(let o of t.bboxes)this.tree.insert({minX:o.minX,minY:o.minY,maxX:o.maxX,maxY:o.maxY,indexedLabel:e}),o.minX<0&&(s=!0),o.maxX>this.dim&&(a=!0);if(s||a){let o=s?this.dim:-this.dim,l=[];for(let d of t.bboxes)l.push({minX:d.minX+o,minY:d.minY,maxX:d.maxX+o,maxY:d.maxY});let f={anchor:new fi.default(t.anchor.x+o,t.anchor.y),bboxes:l,draw:t.draw,order:r,tileKey:i},u=this.current.get(i);u&&u.add(f);for(let d of l)this.tree.insert({minX:d.minX,minY:d.minY,maxX:d.maxX,maxY:d.maxY,indexedLabel:f})}}pruneOrNoop(t){let r=t.split(":"),i,e=0,n=0;for(let s of this.current.keys()){let a=s.split(":");if(a[3]===r[3]){n++;let o=Math.sqrt(N(+a[0]-+r[0],2)+N(+a[1]-+r[1],2));o>e&&(e=o,i=s)}i&&n>this.maxLabeledTiles&&this.pruneKey(i)}}pruneKey(t){let r=this.current.get(t);if(!r)return;let i=[];for(let e of this.tree.all())r.has(e.indexedLabel)&&i.push(e);for(let e of i)this.tree.remove(e);this.current.delete(t)}removeLabel(t){let r=[];for(let e of this.tree.all())t===e.indexedLabel&&r.push(e);for(let e of r)this.tree.remove(e);let i=this.current.get(t.tileKey);i&&i.delete(t)}},yi=class{constructor(t,r,i,e,n){this.index=new mi(256*1<<t,e),this.z=t,this.scratch=r,this.labelRules=i,this.callback=n}layout(t){let r=performance.now(),i=new Set;for(let[n,s]of t)for(let a of s){let o=`${at(a.data_tile)}:${n}`;this.index.has(o)||(this.index.makeEntry(o),i.add(o))}let e=new Set;for(let[n,s]of this.labelRules.entries()){if(s.visible===!1||s.minzoom&&this.z<s.minzoom||s.maxzoom&&this.z>s.maxzoom)continue;let a=s.dataSource||"",o=t.get(a);if(o)for(let l of o){let f=`${at(l.data_tile)}:${a}`;if(!i.has(f))continue;let u=l.data.get(s.dataLayer);if(u===void 0)continue;let d=u;s.sort&&d.sort((x,v)=>s.sort?s.sort(x.props,v.props):0);let w={index:this.index,zoom:this.z,scratch:this.scratch,order:n,overzoom:this.z-l.data_tile.z};for(let x of d){if(s.filter&&!s.filter(this.z,x))continue;let v=Xe(x.geom,l.scale,l.origin),F=s.symbolizer.place(w,v,x);if(F)for(let k of F){let S=!1;if(!(k.deduplicationKey&&this.index.deduplicationCollides(k))){if(this.index.labelCollides(k,1/0)){if(!this.index.labelCollides(k,n)){let c=this.index.searchLabel(k,1/0);for(let m of c){this.index.removeLabel(m);for(let y of m.bboxes)this.findInvalidatedTiles(e,l.dim,y,f)}this.index.insert(k,n,f),S=!0}}else this.index.insert(k,n,f),S=!0;if(S)for(let c of k.bboxes)(c.maxX>l.origin.x+l.dim||c.minX<l.origin.x||c.minY<l.origin.y||c.maxY>l.origin.y+l.dim)&&this.findInvalidatedTiles(e,l.dim,c,f)}}}}}for(let n of i)this.index.pruneOrNoop(n);return e.size>0&&this.callback&&this.callback(e),performance.now()-r}findInvalidatedTiles(t,r,i,e){let n=pi(this.z,r,i);for(let s of n)s.key!==e&&this.index.hasPrefix(s.key)&&t.add(s.display)}add(t){let r=!0;for(let[e,n]of t)for(let s of n)this.index.has(`${at(s.data_tile)}:${e}`)||(r=!1);return r?0:this.layout(t)}},oe=class{constructor(t,r,i,e){this.labelers=new Map,this.scratch=t,this.labelRules=r,this.maxLabeledTiles=i,this.callback=e}add(t,r){let i=this.labelers.get(t);return i||(i=new yi(t,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(t,i)),i.add(r)}getIndex(t){let r=this.labelers.get(t);if(r)return r.index}},wi=W(rt());function gi(t,r,i,e,n,s,a,o,l){let f=performance.now();t.save(),t.miterLimit=2;for(let u of n){if(u.minzoom&&r<u.minzoom||u.maxzoom&&r>u.maxzoom)continue;let d=i.get(u.dataSource||"");if(d)for(let w of d){let x=w.data.get(u.dataLayer);if(x===void 0)continue;u.symbolizer.before&&u.symbolizer.before(t,w.z);let v=w.origin,F=w.dim,k=w.scale;if(t.save(),o){t.beginPath();let S=Math.max(v.x-a.x,s.minX-a.x),c=Math.max(v.y-a.y,s.minY-a.y),m=Math.min(v.x-a.x+F,s.maxX-a.x),y=Math.min(v.y-a.y+F,s.maxY-a.y);t.rect(S,c,m-S,y-c),t.clip()}t.translate(v.x-a.x,v.y-a.y);for(let S of x){let c=S.geom,m=S.bbox;m.maxX*k+v.x<s.minX||m.minX*k+v.x>s.maxX||m.minY*k+v.y>s.maxY||m.maxY*k+v.y<s.minY||u.filter&&!u.filter(w.z,S)||(k!==1&&(c=Xe(c,k,new wi.default(0,0))),u.symbolizer.draw(t,c,w.z,S))}t.restore()}}if(o&&(t.beginPath(),t.rect(s.minX-a.x,s.minY-a.y,s.maxX-s.minX,s.maxY-s.minY),t.clip()),e){let u=e.searchBbox(s,1/0);for(let d of u)if(t.save(),t.translate(d.anchor.x-a.x,d.anchor.y-a.y),d.draw(t),t.restore(),l){t.lineWidth=.5,t.strokeStyle=l,t.fillStyle=l,t.globalAlpha=1,t.fillRect(d.anchor.x-a.x-2,d.anchor.y-a.y-2,4,4);for(let w of d.bboxes)t.strokeRect(w.minX-a.x,w.minY-a.y,w.maxX-w.minX,w.maxY-w.minY)}}return t.restore(),performance.now()-f}var le=(t,r,i)=>[{dataSource:t,dataLayer:r,symbolizer:new Tt({opacity:.2,fill:i,radius:4}),filter:(e,n)=>n.geomType===1},{dataSource:t,dataLayer:r,symbolizer:new tt({opacity:.2,color:i,width:2}),filter:(e,n)=>n.geomType===2},{dataSource:t,dataLayer:r,symbolizer:new $({opacity:.2,fill:i,stroke:i,width:1}),filter:(e,n)=>n.geomType===3}],xi=(t,r)=>{let i=[];for(let[e,n]of t)for(let s of n)for(let a of s.data.keys())e===r.dataSource&&a===r.dataLayer||(i=i.concat(le(e,a,"steelblue")));return i=i.concat(le(r.dataSource||"",r.dataLayer,"red")),i},vi=6378137;var Di=vi*Math.PI;var _i=W(rt()),bi=t=>new Promise((r,i)=>{setTimeout(()=>{r()},t)}),zi=t=>t.then(r=>({status:"fulfilled",value:r}),r=>({status:"rejected",reason:r})),Ye=(t={})=>{class r extends L.GridLayer{constructor(e={}){e.noWrap&&!e.bounds&&(e.bounds=[[-90,-180],[90,180]]),e.attribution==null&&(e.attribution='<a href="https://protomaps.com">Protomaps</a> \xA9 <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(e);let n=e.dark?qt:Wt;this.paint_rules=e.paint_rules||se(n,e.shade),this.label_rules=e.label_rules||ae(n,e.shade,e.language1,e.language2),this.backgroundColor=e.backgroundColor,this.lastRequestedZ=void 0,this.xray=e.xray,this.tasks=e.tasks||[],this.views=di(e),this.debug=e.debug;let s=document.createElement("canvas").getContext("2d");this.scratch=s,this.onTilesInvalidated=a=>{for(let o of a)this.rerenderTile(o)},this.labelers=new oe(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=e.tileDelay||3,this.lang=e.lang,this.inspector=this.inspect(this)}setDefaultStyle(e,n,s,a){let o=e?qt:Wt;this.paint_rules=se(o,n),this.label_rules=ae(o,n,s,a)}renderTile(e,n,s,a=()=>{}){return ft(this,null,function*(){this.lastRequestedZ=e.z;let o=[];for(let[_,M]of this.views){let T=M.getDisplayTile(e);o.push({key:_,promise:T})}let l=yield Promise.all(o.map(_=>_.promise.then(M=>({status:"fulfilled",value:M,key:_.key}),M=>({status:"rejected",reason:M,key:_.key})))),f=new Map;for(let _ of l)_.status==="fulfilled"?f.set(_.key,[_.value]):_.reason.name==="AbortError"||console.error(_.reason);if(n.key!==s||this.lastRequestedZ!==e.z||(yield Promise.all(this.tasks.map(zi)),n.key!==s)||this.lastRequestedZ!==e.z)return;let u=this.labelers.add(e.z,f);if(n.key!==s||this.lastRequestedZ!==e.z)return;let d=this.labelers.getIndex(e.z);if(!this._map)return;let w=this._map.getCenter().wrap(),x=this._getTiledPixelBounds(w),F=this._pxBoundsToTileRange(x).getCenter(),k=e.distanceTo(F)*this.tileDelay;if(yield bi(k),n.key!==s||this.lastRequestedZ!==e.z)return;let S=16,c={minX:256*e.x-S,minY:256*e.y-S,maxX:256*(e.x+1)+S,maxY:256*(e.y+1)+S},m=new _i.default(256*e.x,256*e.y);n.width=this.tile_size,n.height=this.tile_size;let y=n.getContext("2d");y.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),y.clearRect(0,0,256,256),this.backgroundColor&&(y.save(),y.fillStyle=this.backgroundColor,y.fillRect(0,0,256,256),y.restore());let z=0,b=this.paint_rules;if(this.xray&&(b=xi(f,this.xray)),z=gi(y,e.z,f,this.xray?null:d,b,c,m,!1,this.debug),this.debug){y.save(),y.fillStyle=this.debug,y.font="600 12px sans-serif",y.fillText(`${e.z} ${e.x} ${e.y}`,4,14),y.font="12px sans-serif";let _=28;for(let[M,T]of f){let B=T[0].data_tile;y.fillText(`${M+(M?" ":"")+B.z} ${B.x} ${B.y}`,4,_),_+=14}y.font="600 10px sans-serif",z>8&&(y.fillText(`${z.toFixed()} ms paint`,4,_),_+=14),u>8&&y.fillText(`${u.toFixed()} ms layout`,4,_),y.strokeStyle=this.debug,y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(0,256),y.stroke(),y.lineWidth=.5,y.beginPath(),y.moveTo(0,0),y.lineTo(256,0),y.stroke(),y.restore()}a()})}rerenderTile(e){for(let n in this._tiles){let s=this._wrapCoords(this._keyToTileCoords(n));e===this._tileCoordsToKey(s)&&this.renderTile(s,this._tiles[n].el,e)}}clearLayout(){this.labelers=new oe(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let e in this._tiles){let n=this._wrapCoords(this._keyToTileCoords(e)),s=this._tileCoordsToKey(n);this.renderTile(n,this._tiles[e].el,s)}}createTile(e,n){let s=L.DomUtil.create("canvas","leaflet-tile");s.lang=this.lang;let a=this._tileCoordsToKey(e);return s.key=a,this.renderTile(e,s,a,()=>{n(null,s)}),s}_removeTile(e){let n=this._tiles[e];n&&(n.el.removed=!0,n.el.key=void 0,L.DomUtil.removeClass(n.el,"leaflet-tile-loaded"),n.el.width=n.el.height=0,L.DomUtil.remove(n.el),delete this._tiles[e],this.fire("tileunload",{tile:n.el,coords:this._keyToTileCoords(e)}))}queryFeatures(e,n){let s=new Map;for(let[a,o]of this.views)s.set(a,o.queryFeatures(e,n,this._map.getZoom()));return s}inspect(e){return n=>{let s=["\u25CE","\u27CD","\u25FB"],a=e._map.wrapLatLng(n.latlng),o=e.queryFeatures(a.lng,a.lat),l="",f=!0;for(let[u,d]of o)for(let w of d)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===u&&this.xray.dataLayer===w.layerName))){l=`${l}<div style="margin-top:${f?0:.5}em">${s[w.feature.geomType-1]} <b>${u} ${u?"/":""} ${w.layerName}</b> ${w.feature.id||""}</div>`;for(let x in w.feature.props)l=`${l}<div style="font-size:0.9em">${x} = ${w.feature.props[x]}</div>`;f=!1}f&&(l="No features."),L.popup().setLatLng(n.latlng).setContent(`<div style="max-height:400px;overflow-y:scroll;padding-right:8px">${l}</div>`).openOn(e._map)}}addInspector(e){return e.on("click",this.inspector)}removeInspector(e){return e.off("click",this.inspector)}}return new r(t)};function ki(t,r){switch(r){case"dark":t.setDefaultStyle(!0);break;case"grayscale":case"white":t.setDefaultStyle(!1,"white");break;case"black":t.setDefaultStyle(!0,"black");break;default:t.setDefaultStyle();break}t.clearLayout(),t.rerenderTiles()}async function Mi(){let t=await Rt(),r={url:t.service.options.url,attribution:t.service.options.attribution};$t({layerFunction:Ye,layerOptions:r,options:t,setLayerStyle:ki})}Mi();
/*! For license information please see Protomaps-Leaflet.js.LEGAL.txt */
//# sourceMappingURL=Protomaps-Leaflet.js.map
